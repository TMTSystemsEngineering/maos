<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Multi-threaded Adaptive Optics Simulator: maos/setup_recon.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multi-threaded Adaptive Optics Simulator
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('setup__recon_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">setup_recon.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains routines that setup the wavefront reconstructor and DM fitting.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2ade74dd6feba7dba0a4b6f38fe134a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a2ade74dd6feba7dba0a4b6f38fe134a8">setup_recon_tomo_prep</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>
<tr class="memdesc:a2ade74dd6feba7dba0a4b6f38fe134a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares for tomography.  <a href="#a2ade74dd6feba7dba0a4b6f38fe134a8">More...</a><br/></td></tr>
<tr class="separator:a2ade74dd6feba7dba0a4b6f38fe134a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a764bf903a38cfc81220e42699e911884"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a764bf903a38cfc81220e42699e911884">setup_recon_tomo_matrix</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>
<tr class="memdesc:a764bf903a38cfc81220e42699e911884"><td class="mdescLeft">&#160;</td><td class="mdescRight">assemble tomography matrix.  <a href="#a764bf903a38cfc81220e42699e911884">More...</a><br/></td></tr>
<tr class="separator:a764bf903a38cfc81220e42699e911884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa860829623f5076a779fa20d62f5b6d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#aa860829623f5076a779fa20d62f5b6d9">setup_recon_tomo_update</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>
<tr class="memdesc:aa860829623f5076a779fa20d62f5b6d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update assembled tomography matrix with new L2.  <a href="#aa860829623f5076a779fa20d62f5b6d9">More...</a><br/></td></tr>
<tr class="separator:aa860829623f5076a779fa20d62f5b6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a310c15901ee437d44af53a66b22a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a73a310c15901ee437d44af53a66b22a6">setup_recon_mvst</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>
<tr class="memdesc:a73a310c15901ee437d44af53a66b22a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the MVST split tomography NGS mode reconstructor.  <a href="#a73a310c15901ee437d44af53a66b22a6">More...</a><br/></td></tr>
<tr class="separator:a73a310c15901ee437d44af53a66b22a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b87050521ffc455c9cb8edd09f5c6c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a7b87050521ffc455c9cb8edd09f5c6c7">setup_recon_tomo</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structPOWFS__T.html">POWFS_T</a> *powfs, const <a class="el" href="structAPER__T.html">APER_T</a> *aper)</td></tr>
<tr class="memdesc:a7b87050521ffc455c9cb8edd09f5c6c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the tomogrpahy turbulence reconstruction structs including wavefront reconstructor and DM fitting operator.  <a href="#a7b87050521ffc455c9cb8edd09f5c6c7">More...</a><br/></td></tr>
<tr class="separator:a7b87050521ffc455c9cb8edd09f5c6c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743bfb4b4bcf6543a2564d19be192882"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a743bfb4b4bcf6543a2564d19be192882"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup_recon_dmttr</b> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>
<tr class="separator:a743bfb4b4bcf6543a2564d19be192882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff118b091512df4b19987614c6326ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a1ff118b091512df4b19987614c6326ae">setup_recon</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structPOWFS__T.html">POWFS_T</a> *powfs, const <a class="el" href="structAPER__T.html">APER_T</a> *aper)</td></tr>
<tr class="memdesc:a1ff118b091512df4b19987614c6326ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup either the minimum variance reconstructor by calling setup_recon_mvr() or least square reconstructor by calling setup_recon_lsr()  <a href="#a1ff118b091512df4b19987614c6326ae">More...</a><br/></td></tr>
<tr class="separator:a1ff118b091512df4b19987614c6326ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa06f785843d809cffebe5ef4764a7618"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#aa06f785843d809cffebe5ef4764a7618">free_recon_unused</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structRECON__T.html">RECON_T</a> *recon)</td></tr>
<tr class="memdesc:aa06f785843d809cffebe5ef4764a7618"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free unused object in recon struct after preparation is done.  <a href="#aa06f785843d809cffebe5ef4764a7618">More...</a><br/></td></tr>
<tr class="separator:aa06f785843d809cffebe5ef4764a7618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a810c17bd7027feae0decafb93f48efcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__recon_8c.html#a810c17bd7027feae0decafb93f48efcf">free_recon</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structRECON__T.html">RECON_T</a> *recon)</td></tr>
<tr class="memdesc:a810c17bd7027feae0decafb93f48efcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the recon struct.  <a href="#a810c17bd7027feae0decafb93f48efcf">More...</a><br/></td></tr>
<tr class="separator:a810c17bd7027feae0decafb93f48efcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains routines that setup the wavefront reconstructor and DM fitting. </p>
<p>Use parms-&gt;wfsr instead of parms-&gt;wfs for wfs information, which hands GLAO mode correctly.x</p>
<p>TOMOSCALE is used for RLM, RRM, in MVST for M, and in CUDA due to limited dynamic range of single precision floating point numbers.</p>
<p>2014-04-01: Scale saneai, cxx, zzt by TOMOSCALE. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2ade74dd6feba7dba0a4b6f38fe134a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_tomo_prep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares for tomography. </p>
<p>ALlow it to be called multiple times for Cn2 update. </p>

</div>
</div>
<a class="anchor" id="a764bf903a38cfc81220e42699e911884"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_tomo_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assemble tomography matrix. </p>
<p>In CG mode, this function is not executed if tomo.assemble=0, Instead, the algorithm is contained in <a class="el" href="recon_8c.html" title="Wavefront reconstruction and DM fitting routines. ">recon.c</a>. When you modify anything, make sure you also do it there.</p>
<p>For integrated tomograhy:</p>
<p><img class="formulaInl" alt="$\hat{x}=(G_{lgs}^{T}C_{lgs}^{-1}G_{lgs}+C_{x}^{-1}+G_{ngs}^{T}C_{ngs}^{-1} G_{ngs})^{-1}(G_{lgs}^{T}C_{lgs}^{-1}s_{lgs}+G_{ngs}^{T}C_{ngs}^{-1}s_{ngs}){\equiv}RL^{-1}RR s.$" src="form_33.png"/></p>
<p>For split tomography, the terms regarding NGS are dropped:</p>
<p><img class="formulaInl" alt="$\hat{x}_{lgs}=(G_{lgs}^{T}C_{lgs}^{-1}G_{lgs}+C_{x}^{-1})^{-1} G_{lgs}^{T}C_{lgs}^{-1}s_{lgs}\equiv R_L^{-1} R_R s.$" src="form_34.png"/></p>
<p>The left hand side of linear equation (inside the inverse) is stored in RL. The right hand side of the linear equation (outside of the inverse) is stored in RR. The terms regarding the NGS are handled using low rank terms. The gradients from LGS and NGS and concatenated to <img class="formulaInl" alt="$s$" src="form_35.png"/>.</p>
<p>In the LGS part, there is a global tip/tilt removal operator because LGS is insensitive to global tip/tilts.</p>
<p>For details see www.opticsinfobase.org/abstract.cfm?URI=josaa-19-9-1803 </p>

</div>
</div>
<a class="anchor" id="aa860829623f5076a779fa20d62f5b6d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_tomo_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update assembled tomography matrix with new L2. </p>
<p>Called from cn2est when new profiles are available. </p>

</div>
</div>
<a class="anchor" id="a73a310c15901ee437d44af53a66b22a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_mvst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute the MVST split tomography NGS mode reconstructor. </p>
<p>2010-03-16: New Implementation.</p>
<p>Definition:</p>
<ul>
<li><img class="formulaInl" alt="$G_{lgs}$" src="form_36.png"/> is LGS gradient operator from xloc, contained in recon-&gt;GXtomo as dspcell</li>
<li><img class="formulaInl" alt="$G_{ngs}$" src="form_37.png"/> is NGS gradient operator from xloc, contained in recon-&gt;GXL as dense matrix</li>
<li><img class="formulaInl" alt="$C_{lgs}, C_{ngs}$" src="form_38.png"/> is the LGS, and NGS measurement noise covariance matrix.</li>
<li><img class="formulaInl" alt="$\hat{x}_{lgs}$" src="form_39.png"/> is LGS tomography output</li>
<li><img class="formulaInl" alt="$\hat{x}_{ngs}$" src="form_40.png"/> is NGS minimum variance split tomography output</li>
<li><img class="formulaInl" alt="$a_{ngs}$" src="form_41.png"/> is NGS minimum variance DM output.</li>
<li><img class="formulaInl" alt="$F$" src="form_42.png"/> is the fitting operator</li>
<li><img class="formulaInl" alt="$H_A$" src="form_43.png"/> is the ray tracing operator from aloc to ploc, contained in recon-&gt;HA.</li>
<li><img class="formulaInl" alt="$MVModes$" src="form_44.png"/> is the MVST NGS modes</li>
<li><img class="formulaInl" alt="$MVRngs$" src="form_45.png"/> is the MVST NGS reconstructor</li>
</ul>
<p>We have</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \hat{x}_{lgs}&amp;=&amp;A^{-1}G^{T}_{lgs}C_{lgs}^{-1}s_{lgs}\\ Uw&amp;=&amp;A^{-1}G_{ngs}^TC_{ngs}^{-1}\\ \hat{x}_{ngs}&amp;=&amp;Uw(1+G_{ngs}Uw)^{-1}(s_{ngs}-G_{ngs}\hat{x}_{lgs});\\ a_{NGS}&amp;=&amp;F\hat{x}_{ngs}\\ MVModes&amp;=&amp;F\cdot Uw\\ MVRngs&amp;=&amp;(1+G_{ngs}Uw)^{-1} \end{eqnarray*}" src="form_46.png"/>
</p>
<p>If we want to orthnormalize the NGS modes. Propagate the NGS modes <img class="formulaInl" alt="$F\cdot Uw$" src="form_47.png"/> to fitting directions and compute the cross-coupling matrix with weighting on <img class="formulaInl" alt="$W_0, W_1$" src="form_48.png"/>, we have</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} Q&amp;=&amp;H_A\cdot F \cdot Uw\\ M_{CC}&amp;=&amp;Q^T(W_0-W_1 W_1^T)Q\\ \end{eqnarray*}" src="form_49.png"/>
</p>
<p>Do SVD on <img class="formulaInl" alt="$MCC$" src="form_50.png"/> we have <img class="formulaInl" alt="$M_{CC}=u\Sigma v^T $" src="form_51.png"/> where <img class="formulaInl" alt="$u{\equiv}v$" src="form_52.png"/> because <img class="formulaInl" alt="$MCC$" src="form_50.png"/> is symmetric. Redefine the NGS modes and reconstructor as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} MVModes&amp;=&amp;F\cdot Uw\cdot u \Sigma^{-1/2}\\ MVRngs&amp;=&amp;\Sigma^{1/2}u^T (1+G_{ngs}A^{-1}G_{ngs}^T C_{ngs}^{-1})^{-1} \end{eqnarray*}" src="form_53.png"/>
</p>
 
</div>
</div>
<a class="anchor" id="a7b87050521ffc455c9cb8edd09f5c6c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_tomo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPOWFS__T.html">POWFS_T</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAPER__T.html">APER_T</a> *&#160;</td>
          <td class="paramname"><em>aper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the tomogrpahy turbulence reconstruction structs including wavefront reconstructor and DM fitting operator. </p>
<p>Calls <a class="el" href="setup__recon_8c.html#a764bf903a38cfc81220e42699e911884" title="assemble tomography matrix. ">setup_recon_tomo_matrix()</a> and setup_recon_fit_matrix() to setup the tomography and DM fitting matrix.</p>
<p>AHST is handled in <a class="el" href="ahst_8c.html#a55e7a08356d9cc6424c4b549e4a364f2" title="setup NGS modes and reconstructor using AHST for one or two DMs. ">setup_ngsmod()</a>.</p>
<p>MVST is handled in <a class="el" href="setup__recon_8c.html#a73a310c15901ee437d44af53a66b22a6" title="compute the MVST split tomography NGS mode reconstructor. ">setup_recon_mvst()</a>.</p>
<p>MOAO is handled in <a class="el" href="moao_8c.html#ac70e508023f8816854d7d4eaf0452aa6" title="Prepare the propagation H matrix for MOAO and compute the reconstructor. ">setup_recon_moao()</a>. </p>

</div>
</div>
<a class="anchor" id="a1ff118b091512df4b19987614c6326ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPOWFS__T.html">POWFS_T</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAPER__T.html">APER_T</a> *&#160;</td>
          <td class="paramname"><em>aper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup either the minimum variance reconstructor by calling setup_recon_mvr() or least square reconstructor by calling setup_recon_lsr() </p>

</div>
</div>
<a class="anchor" id="aa06f785843d809cffebe5ef4764a7618"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_recon_unused </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free unused object in recon struct after preparation is done. </p>

</div>
</div>
<a class="anchor" id="a810c17bd7027feae0decafb93f48efcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_recon </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&#160;</td>
          <td class="paramname"><em>recon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free the recon struct. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
