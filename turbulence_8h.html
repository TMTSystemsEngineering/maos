<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<title>MAOS: lib/turbulence.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('turbulence_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">turbulence.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;../math/mathdef.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structGENATM__T.html">GENATM_T</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:addf46c2b6461f8cd3045493cb2422b90"><td class="memItemLeft" align="right" valign="top"><a id="addf46c2b6461f8cd3045493cb2422b90"></a>
<a class="el" href="structmap__t.html">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>genatm_simple</b> (real r0, real L0, real dx, <a class="el" href="classlong.html">long</a> nx)</td></tr>
<tr class="separator:addf46c2b6461f8cd3045493cb2422b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2df4e268244fbc0f8ea206aa7a5b51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a6d2df4e268244fbc0f8ea206aa7a5b51">genatm_loc</a> (<a class="el" href="structloc__t.html">loc_t</a> *loc, real r0, real L0)</td></tr>
<tr class="separator:a6d2df4e268244fbc0f8ea206aa7a5b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d72cf5be3e6a6ca5f88ea5b05695778"><td class="memItemLeft" align="right" valign="top"><a id="a3d72cf5be3e6a6ca5f88ea5b05695778"></a>
<a class="el" href="structmapcell.html">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>genatm_from_spect</b> (<a class="el" href="structGENATM__T.html">GENATM_T</a> *data)</td></tr>
<tr class="separator:a3d72cf5be3e6a6ca5f88ea5b05695778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca22cd6ef9fc6877922857c0cd1b746"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapcell.html">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a1ca22cd6ef9fc6877922857c0cd1b746">vonkarman_screen</a> (<a class="el" href="structGENATM__T.html">GENATM_T</a> *data)</td></tr>
<tr class="separator:a1ca22cd6ef9fc6877922857c0cd1b746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5ee62565509406b8712a9e9f16af97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapcell.html">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a1a5ee62565509406b8712a9e9f16af97">biharmonic_screen</a> (<a class="el" href="structGENATM__T.html">GENATM_T</a> *data)</td></tr>
<tr class="separator:a1a5ee62565509406b8712a9e9f16af97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb514bab0df876eeb65154d87b58e47d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapcell.html">mapcell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#aeb514bab0df876eeb65154d87b58e47d">fractal_screen</a> (<a class="el" href="structGENATM__T.html">GENATM_T</a> *data)</td></tr>
<tr class="separator:aeb514bab0df876eeb65154d87b58e47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355ca2e7672a29cbefea042caba47c47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a355ca2e7672a29cbefea042caba47c47">turbcov</a> (<a class="el" href="structdmat.html">dmat</a> *r, real rmax, real r0, real L0)</td></tr>
<tr class="separator:a355ca2e7672a29cbefea042caba47c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003ba466f6608495ae22890661663e8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a003ba466f6608495ae22890661663e8e">spatial_psd</a> (<a class="el" href="structdmat.html">dmat</a> **out, <a class="el" href="classlong.html">long</a> nx, <a class="el" href="classlong.html">long</a> ny, real dx, real strength, real L0, real fmin, real fmax, real slope, real power)</td></tr>
<tr class="separator:a003ba466f6608495ae22890661663e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac871dc0baf2241c719fa67f892f292"><td class="memItemLeft" align="right" valign="top"><a id="a5ac871dc0baf2241c719fa67f892f292"></a>
<a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>turbpsd</b> (<a class="el" href="classlong.html">long</a> nx, <a class="el" href="classlong.html">long</a> ny, real dx, real r0, real L0, real slope, real power)</td></tr>
<tr class="separator:a5ac871dc0baf2241c719fa67f892f292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f1950319bbbf2a5537b853bdb3b879"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a24f1950319bbbf2a5537b853bdb3b879">calc_aniso</a> (real r0, int nht, real *ht, real *wt)</td></tr>
<tr class="separator:a24f1950319bbbf2a5537b853bdb3b879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a7c973125f67a96ac67f93fe400e5d"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#a44a7c973125f67a96ac67f93fe400e5d">calc_greenwood</a> (real r0, int nps, real *ws, real *wt)</td></tr>
<tr class="separator:a44a7c973125f67a96ac67f93fe400e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56dc39765ac225d9183cccfa7583a02"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8h.html#af56dc39765ac225d9183cccfa7583a02">calc_aniso2</a> (real r0, int nht, real *ht, real *wt, real hc1, real hc2)</td></tr>
<tr class="separator:af56dc39765ac225d9183cccfa7583a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains routines to generate atmospheric turbulence screens </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6d2df4e268244fbc0f8ea206aa7a5b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2df4e268244fbc0f8ea206aa7a5b51">&#9670;&nbsp;</a></span>genatm_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdmat.html">dmat</a>* genatm_loc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structloc__t.html">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dsa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate atmosphere and map onto loc. </p>

</div>
</div>
<a id="a1ca22cd6ef9fc6877922857c0cd1b746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca22cd6ef9fc6877922857c0cd1b746">&#9670;&nbsp;</a></span>vonkarman_screen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapcell.html">mapcell</a>* vonkarman_screen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENATM__T.html">GENATM_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate vonkarman screens from turbulence statistics. </p>

</div>
</div>
<a id="a1a5ee62565509406b8712a9e9f16af97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5ee62565509406b8712a9e9f16af97">&#9670;&nbsp;</a></span>biharmonic_screen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapcell.html">mapcell</a>* biharmonic_screen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENATM__T.html">GENATM_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate screens from PSD with power of 12/3 instead of 11/3. </p>

</div>
</div>
<a id="aeb514bab0df876eeb65154d87b58e47d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb514bab0df876eeb65154d87b58e47d">&#9670;&nbsp;</a></span>fractal_screen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapcell.html">mapcell</a>* fractal_screen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENATM__T.html">GENATM_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate Fractal screens. Not good statistics. </p>

</div>
</div>
<a id="a355ca2e7672a29cbefea042caba47c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a355ca2e7672a29cbefea042caba47c47">&#9670;&nbsp;</a></span>turbcov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdmat.html">dmat</a>* turbcov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>L0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the covariance for separation of r, and put the values in cov. In kolmogorov spectrum, the variance are defined as half of the structure function between two points separated by rmax. </p>

</div>
</div>
<a id="a003ba466f6608495ae22890661663e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a003ba466f6608495ae22890661663e8e">&#9670;&nbsp;</a></span>spatial_psd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spatial_psd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlong.html">long</a>&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>outerscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>minfreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>maxfreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates 2-d PSD at size nx*ny: psd=(strength*(f^2+L0^-2)^(slope/2))^power. Zero frequency component is in the corner psd-&gt;p[0]. </p>

</div>
</div>
<a id="a24f1950319bbbf2a5537b853bdb3b879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f1950319bbbf2a5537b853bdb3b879">&#9670;&nbsp;</a></span>calc_aniso()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_aniso </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights. <br  />
 </p>

</div>
</div>
<a id="a44a7c973125f67a96ac67f93fe400e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a7c973125f67a96ac67f93fe400e5d">&#9670;&nbsp;</a></span>calc_greenwood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_greenwood </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate Green wood frequency </p>

</div>
</div>
<a id="af56dc39765ac225d9183cccfa7583a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af56dc39765ac225d9183cccfa7583a02">&#9670;&nbsp;</a></span>calc_aniso2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real calc_aniso2 </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real *&#160;</td>
          <td class="paramname"><em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>hc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>hc2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
