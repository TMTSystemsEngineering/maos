<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Multi-threaded Adaptive Optics Simulator: maos/utils.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multi-threaded Adaptive Optics Simulator
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('maos_2utils_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">utils.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A few utility routines.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6ddefc7009bf723f3d8e13466a902f03"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ddefc7009bf723f3d8e13466a902f03"></a>
typedef struct PSFCOMP_T&#160;</td><td class="memItemRight" valign="bottom"><b>PSFCOMP_T</b></td></tr>
<tr class="separator:a6ddefc7009bf723f3d8e13466a902f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a25c26cc7bf98368cc8e5b86e7dff8849"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a25c26cc7bf98368cc8e5b86e7dff8849">addnoise</a> (<a class="el" href="structdmat.html">dmat</a> *A, <a class="el" href="structmt__state.html">rand_t</a> *rstat, const double bkgrnd, const double pcalib, const double *bkgrnd2, const double *bkgrnd2c, const double rne)</td></tr>
<tr class="memdesc:a25c26cc7bf98368cc8e5b86e7dff8849"><td class="mdescLeft">&#160;</td><td class="mdescRight">add photon and read out noise.  <a href="#a25c26cc7bf98368cc8e5b86e7dff8849">More...</a><br/></td></tr>
<tr class="separator:a25c26cc7bf98368cc8e5b86e7dff8849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7201760699d43c972676fda5146739"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmap__t.html">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a2a7201760699d43c972676fda5146739">create_metapupil_wrap</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double ht, double dx, double dy, double offset, double guard, long ninx, long niny, int pad, int square)</td></tr>
<tr class="memdesc:a2a7201760699d43c972676fda5146739"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls create_metapupil is simplified interface by returning a <a class="el" href="structmap__t.html" title="OPD or Amplitude map defined on square/rectangular grids.">map_t</a> object.  <a href="#a2a7201760699d43c972676fda5146739">More...</a><br/></td></tr>
<tr class="separator:a2a7201760699d43c972676fda5146739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed593dee7ff9a98e27661ac68ede4bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a8ed593dee7ff9a98e27661ac68ede4bb">create_metapupil</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double ht, double dx, double dy, double offset, long *nxout, long *nyout, double *oxout, double *oyout, double **map, double guard, long ninx, long niny, int pad, int square)</td></tr>
<tr class="memdesc:a8ed593dee7ff9a98e27661ac68ede4bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">create a metapupil map, with size nx*ny, origin at (ox,oy), sampling of dx, height of ht, that can cover all the WFS and science beams.  <a href="#a8ed593dee7ff9a98e27661ac68ede4bb">More...</a><br/></td></tr>
<tr class="separator:a8ed593dee7ff9a98e27661ac68ede4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6846a7e8753720495fab427eb73a333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#aa6846a7e8753720495fab427eb73a333">plotloc</a> (char *fig, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structloc__t.html">loc_t</a> *loc, double ht, char *format,...)</td></tr>
<tr class="memdesc:aa6846a7e8753720495fab427eb73a333"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the projection of all the different FoVs on a certain grid.  <a href="#aa6846a7e8753720495fab427eb73a333">More...</a><br/></td></tr>
<tr class="separator:aa6846a7e8753720495fab427eb73a333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f83b9d00296996ebdaff0335ef4340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a17f83b9d00296996ebdaff0335ef4340">plotdir</a> (char *fig, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double totfov, char *format,...)</td></tr>
<tr class="memdesc:a17f83b9d00296996ebdaff0335ef4340"><td class="mdescLeft">&#160;</td><td class="mdescRight">ploted all the different beam directions as points.  <a href="#a17f83b9d00296996ebdaff0335ef4340">More...</a><br/></td></tr>
<tr class="separator:a17f83b9d00296996ebdaff0335ef4340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83a1d1fc29af913013c954d41d34490"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#af83a1d1fc29af913013c954d41d34490">rename_file</a> (int sig)</td></tr>
<tr class="memdesc:af83a1d1fc29af913013c954d41d34490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rename the log files when simulation exits.  <a href="#af83a1d1fc29af913013c954d41d34490">More...</a><br/></td></tr>
<tr class="separator:af83a1d1fc29af913013c954d41d34490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6331baae7550213ee98a12f9c3bbc5ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a6331baae7550213ee98a12f9c3bbc5ce">maos_signal_handler</a> (int sig)</td></tr>
<tr class="memdesc:a6331baae7550213ee98a12f9c3bbc5ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles signals.  <a href="#a6331baae7550213ee98a12f9c3bbc5ce">More...</a><br/></td></tr>
<tr class="separator:a6331baae7550213ee98a12f9c3bbc5ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad91533fa7ecab0db34f47b51c55edd6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structARG__T.html">ARG_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#aad91533fa7ecab0db34f47b51c55edd6">parse_args</a> (int argc, const char *argv[])</td></tr>
<tr class="memdesc:aad91533fa7ecab0db34f47b51c55edd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse command line arguments argc, argv.  <a href="#aad91533fa7ecab0db34f47b51c55edd6">More...</a><br/></td></tr>
<tr class="separator:aad91533fa7ecab0db34f47b51c55edd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac016dcc985dec7741db2ff6118f8de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcmat.html">cmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#afac016dcc985dec7741db2ff6118f8de">strehlcomp</a> (const <a class="el" href="structdmat.html">dmat</a> *iopdevl, const double *amp, const double wvl)</td></tr>
<tr class="memdesc:afac016dcc985dec7741db2ff6118f8de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes strehl from OPD without doing FFT.  <a href="#afac016dcc985dec7741db2ff6118f8de">More...</a><br/></td></tr>
<tr class="separator:afac016dcc985dec7741db2ff6118f8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb8db3a2777ac6e30bb47af9101324b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structccell.html">ccell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#adb8db3a2777ac6e30bb47af9101324b8">psfcomp</a> (const <a class="el" href="structdmat.html">dmat</a> *iopdevl, const double *amp, long **embeds, const long *nembeds, const int *psfsize, const int nwvl, const double *wvl)</td></tr>
<tr class="memdesc:adb8db3a2777ac6e30bb47af9101324b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call psfcomp_iwvl in parallel to compute PSF in each wvl.  <a href="#adb8db3a2777ac6e30bb47af9101324b8">More...</a><br/></td></tr>
<tr class="separator:adb8db3a2777ac6e30bb47af9101324b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25aba0a3101a4f153c4752b31513a91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#aa25aba0a3101a4f153c4752b31513a91">psfcomp_iwvl</a> (<a class="el" href="structthread__t.html">thread_t</a> *thdata)</td></tr>
<tr class="memdesc:aa25aba0a3101a4f153c4752b31513a91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes PSF from OPD by doing FFT.  <a href="#aa25aba0a3101a4f153c4752b31513a91">More...</a><br/></td></tr>
<tr class="separator:aa25aba0a3101a4f153c4752b31513a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8c62a4ca2f063bea3a863d2f7e0107"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#abd8c62a4ca2f063bea3a863d2f7e0107">embed_in</a> (double *out, const double *in, long nin, long *embed)</td></tr>
<tr class="memdesc:abd8c62a4ca2f063bea3a863d2f7e0107"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#abd8c62a4ca2f063bea3a863d2f7e0107">More...</a><br/></td></tr>
<tr class="separator:abd8c62a4ca2f063bea3a863d2f7e0107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82fb97c6bab04cdbdc0867c62c76626a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a82fb97c6bab04cdbdc0867c62c76626a">embed_out</a> (const double *out, double *in, long nin, long *embed)</td></tr>
<tr class="memdesc:a82fb97c6bab04cdbdc0867c62c76626a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#a82fb97c6bab04cdbdc0867c62c76626a">More...</a><br/></td></tr>
<tr class="separator:a82fb97c6bab04cdbdc0867c62c76626a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae42946e50ae83f2aaf0a9b138495b04"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#aae42946e50ae83f2aaf0a9b138495b04">embedc_in</a> (dcomplex *out, const double *in, long nin, long *embed)</td></tr>
<tr class="memdesc:aae42946e50ae83f2aaf0a9b138495b04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#aae42946e50ae83f2aaf0a9b138495b04">More...</a><br/></td></tr>
<tr class="separator:aae42946e50ae83f2aaf0a9b138495b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a388084f54494bcbeb13bf14450771203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a388084f54494bcbeb13bf14450771203">embedc_out</a> (const dcomplex *out, double *in, long nin, long *embed)</td></tr>
<tr class="memdesc:a388084f54494bcbeb13bf14450771203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#a388084f54494bcbeb13bf14450771203">More...</a><br/></td></tr>
<tr class="separator:a388084f54494bcbeb13bf14450771203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7b446004c896c4369a93a863815d77"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a5c7b446004c896c4369a93a863815d77">calc_aniso</a> (double r0, int nht, double *ht, double *wt)</td></tr>
<tr class="memdesc:a5c7b446004c896c4369a93a863815d77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights.  <a href="#a5c7b446004c896c4369a93a863815d77">More...</a><br/></td></tr>
<tr class="separator:a5c7b446004c896c4369a93a863815d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066f38258e20d362d1e184a397697828"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a066f38258e20d362d1e184a397697828">calc_aniso2</a> (double r0, int nht, double *ht, double *wt, double hc1, double hc2)</td></tr>
<tr class="memdesc:a066f38258e20d362d1e184a397697828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs.  <a href="#a066f38258e20d362d1e184a397697828">More...</a><br/></td></tr>
<tr class="separator:a066f38258e20d362d1e184a397697828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42587bb89ea768b120b893036125bd92"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a42587bb89ea768b120b893036125bd92"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>evl_header</b> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, const <a class="el" href="structAPER__T.html">APER_T</a> *aper, int ievl, int iwvl)</td></tr>
<tr class="separator:a42587bb89ea768b120b893036125bd92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4d170177b3cdad0db1efefa5386bc7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc4d170177b3cdad0db1efefa5386bc7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>apply_fieldstop</b> (<a class="el" href="structdmat.html">dmat</a> *opd, <a class="el" href="structdmat.html">dmat</a> *amp, long *embed, long nembed, <a class="el" href="structdmat.html">dmat</a> *fieldstop, double wvl)</td></tr>
<tr class="separator:afc4d170177b3cdad0db1efefa5386bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d7d174efd394be9afc432ca1835071"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a02d7d174efd394be9afc432ca1835071"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>plot_setup</b> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, const <a class="el" href="structPOWFS__T.html">POWFS_T</a> *powfs, const <a class="el" href="structAPER__T.html">APER_T</a> *aper, const <a class="el" href="structRECON__T.html">RECON_T</a> *recon)</td></tr>
<tr class="separator:a02d7d174efd394be9afc432ca1835071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b318f91abca40a6ff8f35badd65338"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67b318f91abca40a6ff8f35badd65338"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>maos_daemon</b> (int sock)</td></tr>
<tr class="separator:a67b318f91abca40a6ff8f35badd65338"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A few utility routines. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a25c26cc7bf98368cc8e5b86e7dff8849"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addnoise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmt__state.html">rand_t</a> *&#160;</td>
          <td class="paramname"><em>rstat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>bkgrnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>pcalib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>bkgrnd2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>bkgrnd2c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rne</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add photon and read out noise. </p>
<p>pcalib part of bkgrnd is calibrated out. pcalib2 part of bkgrnd2 is calibrated out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The pixel intensity array </td></tr>
    <tr><td class="paramname">rstat</td><td>The random stream </td></tr>
    <tr><td class="paramname">bkgrnd</td><td>background in PDEs per pixel per frame </td></tr>
    <tr><td class="paramname">pcalib</td><td>Fraction of bkgrnd that is calibrated out </td></tr>
    <tr><td class="paramname">bkgrnd2</td><td>background in PDEs of each pixel per frame. </td></tr>
    <tr><td class="paramname">bkgrnd2c</td><td>calibration bkgrnd2 </td></tr>
    <tr><td class="paramname">rne</td><td>Read out noise per pixel per read </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2a7201760699d43c972676fda5146739"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmap__t.html">map_t</a>* create_metapupil_wrap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ninx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>niny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>square</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls create_metapupil is simplified interface by returning a <a class="el" href="structmap__t.html" title="OPD or Amplitude map defined on square/rectangular grids.">map_t</a> object. </p>

</div>
</div>
<a class="anchor" id="a8ed593dee7ff9a98e27661ac68ede4bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_metapupil </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>nxout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>nyout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>oxout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>oyout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ninx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>niny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>square</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create a metapupil map, with size nx*ny, origin at (ox,oy), sampling of dx, height of ht, that can cover all the WFS and science beams. </p>
<p>offset: distance in pixel from the point closest to the origin to origin (right side). 0: there is a point on the origin. 1/2: the closest point to origin is 1/2 pixel.</p>
<p>pad: 1: round nx, ny to power of 2. </p>

</div>
</div>
<a class="anchor" id="aa6846a7e8753720495fab427eb73a333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plotloc </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structloc__t.html">loc_t</a> *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the projection of all the different FoVs on a certain grid. </p>
<p>used in setup_recon </p>

</div>
</div>
<a class="anchor" id="a17f83b9d00296996ebdaff0335ef4340"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plotdir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&#160;</td>
          <td class="paramname"><em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>totfov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ploted all the different beam directions as points. </p>
<p>used in setup_parms </p>

</div>
</div>
<a class="anchor" id="af83a1d1fc29af913013c954d41d34490"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rename_file </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rename the log files when simulation exits. </p>

</div>
</div>
<a class="anchor" id="a6331baae7550213ee98a12f9c3bbc5ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maos_signal_handler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles signals. </p>

</div>
</div>
<a class="anchor" id="aad91533fa7ecab0db34f47b51c55edd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structARG__T.html">ARG_T</a>* parse_args </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse command line arguments argc, argv. </p>

</div>
</div>
<a class="anchor" id="afac016dcc985dec7741db2ff6118f8de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcmat.html">cmat</a>* strehlcomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>iopdevl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wvl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes strehl from OPD without doing FFT. </p>
<p>The strehl is simply</p>
<p><img class="formulaInl" alt="$s=\sum(A*exp[\frac{2\pi i}{\lambda}*\textrm{OPD}]) $" src="form_56.png"/></p>
<p>where A is the amplitude map. </p>

</div>
</div>
<a class="anchor" id="adb8db3a2777ac6e30bb47af9101324b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structccell.html">ccell</a>* psfcomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>iopdevl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long **&#160;</td>
          <td class="paramname"><em>embeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>nembeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>psfsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>wvl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call psfcomp_iwvl in parallel to compute PSF in each wvl. </p>

</div>
</div>
<a class="anchor" id="aa25aba0a3101a4f153c4752b31513a91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void psfcomp_iwvl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structthread__t.html">thread_t</a> *&#160;</td>
          <td class="paramname"><em>thdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes PSF from OPD by doing FFT. </p>
<p>The PSF is computed as</p>
<p><img class="formulaInl" alt="$\textrm{PSF}=\mathcal{F}[A\times exp[\frac{2\pi i}{\lambda}*\textrm{OPD}]]$" src="form_57.png"/></p>
<p>The peak value (center) in the computed PSF is normalized by the peak value in the differaction limited PSF. In other words, the peak value in the computed PSF is the Strehl. Keep this in mind when you compute enclosed energy. </p>

</div>
</div>
<a class="anchor" id="abd8c62a4ca2f063bea3a863d2f7e0107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embed_in </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>embed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple embed and accumulation. </p>

</div>
</div>
<a class="anchor" id="a82fb97c6bab04cdbdc0867c62c76626a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embed_out </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>embed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple embed and accumulation. </p>

</div>
</div>
<a class="anchor" id="aae42946e50ae83f2aaf0a9b138495b04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embedc_in </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>embed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple embed and accumulation. </p>
<p>for complex output </p>

</div>
</div>
<a class="anchor" id="a388084f54494bcbeb13bf14450771203"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embedc_out </td>
          <td>(</td>
          <td class="paramtype">const dcomplex *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>embed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple embed and accumulation. </p>
<p>for real output. </p>

</div>
</div>
<a class="anchor" id="a5c7b446004c896c4369a93a863815d77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_aniso </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>wt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights. </p>

</div>
</div>
<a class="anchor" id="a066f38258e20d362d1e184a397697828"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_aniso2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hc2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
