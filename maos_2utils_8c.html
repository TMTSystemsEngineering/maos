<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>maos-0.7.5: maos/utils.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>maos/utils.c File Reference</h1>A few utility routines.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a599b7b828e46442f89af20deeec9bf7">addnoise</a> (<a class="el" href="structdmat.html">dmat</a> *A, <a class="el" href="structmt__state.html">rand_t</a> *rstat, const double bkgrnd, const double pcalib, const double *bkgrnd2, const double pcalib2, const double rne)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add photon and read out noise.  <a href="#a599b7b828e46442f89af20deeec9bf7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structmap__t.html">map_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#026c58738a2dedbdfb7cc89b08f65332">create_metapupil_wrap</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double ht, double dx, double offset, double guard, long nin, T_TYPE type, int pad, int square)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calls create_metapupil is simplified interface by returning a <a class="el" href="structmap__t.html" title="OPD or Amplitude map defined on square/rectangular grids.">map_t</a> object.  <a href="#026c58738a2dedbdfb7cc89b08f65332"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#480912f463af16b1beec7b915c32acde">create_metapupil</a> (const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double ht, double dx, double offset, long *nxout, long *nyout, double *oxout, double *oyout, double **map, double guard, long nin, T_TYPE type, int pad, int square)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">create a metapupil map, with size nx*ny, origin at (ox,oy), sampling of dx, height of ht, that can cover all the WFS and science beams.  <a href="#480912f463af16b1beec7b915c32acde"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a6846a7e8753720495fab427eb73a333">plotloc</a> (char *fig, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, <a class="el" href="structloc__t.html">loc_t</a> *loc, double ht, char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plot the projection of all the different FoVs on a certain grid.  <a href="#a6846a7e8753720495fab427eb73a333"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#17f83b9d00296996ebdaff0335ef4340">plotdir</a> (char *fig, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, double totfov, char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ploted all the different beam directions as points.  <a href="#17f83b9d00296996ebdaff0335ef4340"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#f83a1d1fc29af913013c954d41d34490">rename_file</a> (int sig)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rename the log files when simulation exits.  <a href="#f83a1d1fc29af913013c954d41d34490"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#6331baae7550213ee98a12f9c3bbc5ce">maos_signal_handler</a> (int sig)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handles signals.  <a href="#6331baae7550213ee98a12f9c3bbc5ce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#0edd37fe65f6a8b1e530370f6e6402f3">print_usage</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print out usage information.  <a href="#0edd37fe65f6a8b1e530370f6e6402f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structARG__T.html">ARG_T</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#cb9c938dc842d5c52a16c7443fdb4ae3">parse_args</a> (int argc, char **argv)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse command line arguments argc, argv.  <a href="#cb9c938dc842d5c52a16c7443fdb4ae3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structccell.html">ccell</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#23f278c19893472d21761319c7eb4ebc">strehlcomp</a> (const <a class="el" href="structdmat.html">dmat</a> *iopdevl, const double *amp, const int nwvl, const double *wvl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes strehl from OPD without doing FFT.  <a href="#23f278c19893472d21761319c7eb4ebc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structccell.html">ccell</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#ae7f6abee9a2af7836c61f3d76e3eda2">psfcomp</a> (const <a class="el" href="structdmat.html">dmat</a> *iopdevl, const double *amp, int **embeds, const int *nembeds, const int psfsize, const int nwvl, const double *wvl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes PSF from OPD by doing FFT.  <a href="#ae7f6abee9a2af7836c61f3d76e3eda2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#bd8c62a4ca2f063bea3a863d2f7e0107">embed_in</a> (double *out, const double *in, long nin, long *embed)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#bd8c62a4ca2f063bea3a863d2f7e0107"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#82fb97c6bab04cdbdc0867c62c76626a">embed_out</a> (const double *out, double *in, long nin, long *embed)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple embed and accumulation.  <a href="#82fb97c6bab04cdbdc0867c62c76626a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#a54aacd870579af5c2d7f1023f7a5624">lock_seeds</a> (<a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to lock file for each seed.  <a href="#a54aacd870579af5c2d7f1023f7a5624"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#5c7b446004c896c4369a93a863815d77">calc_aniso</a> (double r0, int nht, double *ht, double *wt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights.  <a href="#5c7b446004c896c4369a93a863815d77"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maos_2utils_8c.html#066f38258e20d362d1e184a397697828">calc_aniso2</a> (double r0, int nht, double *ht, double *wt, double hc1, double hc2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs.  <a href="#066f38258e20d362d1e184a397697828"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A few utility routines. 
<p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a599b7b828e46442f89af20deeec9bf7"></a><!-- doxytag: member="utils.c::addnoise" ref="a599b7b828e46442f89af20deeec9bf7" args="(dmat *A, rand_t *rstat, const double bkgrnd, const double pcalib, const double *bkgrnd2, const double pcalib2, const double rne)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addnoise           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmt__state.html">rand_t</a> *&nbsp;</td>
          <td class="paramname"> <em>rstat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>bkgrnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>pcalib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>bkgrnd2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>pcalib2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>rne</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
add photon and read out noise. 
<p>
pcalib part of bkgrnd is calibrated out. pcalib2 part of bkgrnd2 is calibrated out. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>The pixel intensity array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rstat</em>&nbsp;</td><td>The random stream </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bkgrnd</em>&nbsp;</td><td>background in PDEs per pixel per frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pcalib</em>&nbsp;</td><td>Fraction of bkgrnd that is calibrated out </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bkgrnd2</em>&nbsp;</td><td>background in PDEs of each pixel per frame. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pcalib2</em>&nbsp;</td><td>Fraction of bkgrnd taht is calibrated out </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rne</em>&nbsp;</td><td>Read out noise per pixel per read </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="026c58738a2dedbdfb7cc89b08f65332"></a><!-- doxytag: member="utils.c::create_metapupil_wrap" ref="026c58738a2dedbdfb7cc89b08f65332" args="(const PARMS_T *parms, double ht, double dx, double offset, double guard, long nin, T_TYPE type, int pad, int square)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmap__t.html">map_t</a>* create_metapupil_wrap           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T_TYPE&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>square</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calls create_metapupil is simplified interface by returning a <a class="el" href="structmap__t.html" title="OPD or Amplitude map defined on square/rectangular grids.">map_t</a> object. 
<p>

</div>
</div><p>
<a class="anchor" name="480912f463af16b1beec7b915c32acde"></a><!-- doxytag: member="utils.c::create_metapupil" ref="480912f463af16b1beec7b915c32acde" args="(const PARMS_T *parms, double ht, double dx, double offset, long *nxout, long *nyout, double *oxout, double *oyout, double **map, double guard, long nin, T_TYPE type, int pad, int square)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_metapupil           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>nxout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>nyout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>oxout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>oyout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T_TYPE&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>square</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
create a metapupil map, with size nx*ny, origin at (ox,oy), sampling of dx, height of ht, that can cover all the WFS and science beams. 
<p>
offset: distance in pixel from the point closest to the origin to origin (right side). 0: there is a point on the origin. 1/2: the closest point to origin is 1/2 pixel.<p>
pad: 1: round nx, ny to power of 2. 
</div>
</div><p>
<a class="anchor" name="a6846a7e8753720495fab427eb73a333"></a><!-- doxytag: member="utils.c::plotloc" ref="a6846a7e8753720495fab427eb73a333" args="(char *fig, const PARMS_T *parms, loc_t *loc, double ht, char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plotloc           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structloc__t.html">loc_t</a> *&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Plot the projection of all the different FoVs on a certain grid. 
<p>
used in setup_recon 
</div>
</div><p>
<a class="anchor" name="17f83b9d00296996ebdaff0335ef4340"></a><!-- doxytag: member="utils.c::plotdir" ref="17f83b9d00296996ebdaff0335ef4340" args="(char *fig, const PARMS_T *parms, double totfov, char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plotdir           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>totfov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
ploted all the different beam directions as points. 
<p>
used in setup_parms 
</div>
</div><p>
<a class="anchor" name="f83a1d1fc29af913013c954d41d34490"></a><!-- doxytag: member="utils.c::rename_file" ref="f83a1d1fc29af913013c954d41d34490" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rename_file           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Rename the log files when simulation exits. 
<p>

</div>
</div><p>
<a class="anchor" name="6331baae7550213ee98a12f9c3bbc5ce"></a><!-- doxytag: member="utils.c::maos_signal_handler" ref="6331baae7550213ee98a12f9c3bbc5ce" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maos_signal_handler           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handles signals. 
<p>
We don't want to exit the simulation when SIGPIPE happens (when we are writing to closed sockets) 
</div>
</div><p>
<a class="anchor" name="0edd37fe65f6a8b1e530370f6e6402f3"></a><!-- doxytag: member="utils.c::print_usage" ref="0edd37fe65f6a8b1e530370f6e6402f3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void print_usage           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Print out usage information. 
<p>

</div>
</div><p>
<a class="anchor" name="cb9c938dc842d5c52a16c7443fdb4ae3"></a><!-- doxytag: member="utils.c::parse_args" ref="cb9c938dc842d5c52a16c7443fdb4ae3" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structARG__T.html">ARG_T</a>* parse_args           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parse command line arguments argc, argv. 
<p>

</div>
</div><p>
<a class="anchor" name="23f278c19893472d21761319c7eb4ebc"></a><!-- doxytag: member="utils.c::strehlcomp" ref="23f278c19893472d21761319c7eb4ebc" args="(const dmat *iopdevl, const double *amp, const int nwvl, const double *wvl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structccell.html">ccell</a>* strehlcomp           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&nbsp;</td>
          <td class="paramname"> <em>iopdevl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>nwvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>wvl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Computes strehl from OPD without doing FFT. 
<p>
The strehl is simply<p>
<img class="formulaInl" alt="$s=\sum(A*exp[\frac{2\pi i}{\lambda}*\textrm{OPD}]) $" src="form_64.png"><p>
where A is the amplitude map. 
</div>
</div><p>
<a class="anchor" name="ae7f6abee9a2af7836c61f3d76e3eda2"></a><!-- doxytag: member="utils.c::psfcomp" ref="ae7f6abee9a2af7836c61f3d76e3eda2" args="(const dmat *iopdevl, const double *amp, int **embeds, const int *nembeds, const int psfsize, const int nwvl, const double *wvl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structccell.html">ccell</a>* psfcomp           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&nbsp;</td>
          <td class="paramname"> <em>iopdevl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>embeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>nembeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>psfsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>nwvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>wvl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Computes PSF from OPD by doing FFT. 
<p>
The PSF is computed as<p>
<img class="formulaInl" alt="$\textrm{PSF}=\mathcal{F}[A\times exp[\frac{2\pi i}{\lambda}*\textrm{OPD}]]$" src="form_65.png"><p>
The peak value (center) in the computed PSF is normalized by the peak value in the differaction limited PSF. In other words, the peak value in the computed PSF is the Strehl. Keep this in mind when you compute enclosed energy. 
</div>
</div><p>
<a class="anchor" name="bd8c62a4ca2f063bea3a863d2f7e0107"></a><!-- doxytag: member="utils.c::embed_in" ref="bd8c62a4ca2f063bea3a863d2f7e0107" args="(double *out, const double *in, long nin, long *embed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embed_in           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>embed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Simple embed and accumulation. 
<p>

</div>
</div><p>
<a class="anchor" name="82fb97c6bab04cdbdc0867c62c76626a"></a><!-- doxytag: member="utils.c::embed_out" ref="82fb97c6bab04cdbdc0867c62c76626a" args="(const double *out, double *in, long nin, long *embed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void embed_out           </td>
          <td>(</td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>embed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Simple embed and accumulation. 
<p>

</div>
</div><p>
<a class="anchor" name="a54aacd870579af5c2d7f1023f7a5624"></a><!-- doxytag: member="utils.c::lock_seeds" ref="a54aacd870579af5c2d7f1023f7a5624" args="(PARMS_T *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lock_seeds           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Try to lock file for each seed. 
<p>
If file is already locked by other process, will not run that seed tox not step over other process's feet. 
</div>
</div><p>
<a class="anchor" name="5c7b446004c896c4369a93a863815d77"></a><!-- doxytag: member="utils.c::calc_aniso" ref="5c7b446004c896c4369a93a863815d77" args="(double r0, int nht, double *ht, double *wt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_aniso           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>wt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Estimate anisoplanatic angle theta0 from Fried parameter r0, layer height and weights. 
<p>

</div>
</div><p>
<a class="anchor" name="066f38258e20d362d1e184a397697828"></a><!-- doxytag: member="utils.c::calc_aniso2" ref="066f38258e20d362d1e184a397697828" args="(double r0, int nht, double *ht, double *wt, double hc1, double hc2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_aniso2           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>hc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>hc2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Estimate generalized aniso angle theta2 from Fried parameter r0, and layer height and weights, and deformable mirror conjugation heights hc1 hc2 of the ground and altitude DMs. 
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Nov 24 14:46:54 2010 for maos-0.7.5 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
