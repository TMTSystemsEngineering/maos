<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Multi-threaded Adaptive Optics Simulator: Simulation Results</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multi-threaded Adaptive Optics Simulator
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page40.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Simulation Results </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>MAOS will generate output in binary format <code></code>.bin files (which maybe gzipped) as described below.</p>
<p>PSFs are written into fits files with extensions.</p>
<h1><a class="anchor" id="sect-matlab"></a>
Reading Results in MATLAB</h1>
<p>There are two MATLAB <code>mex</code> routines <code>read</code> and <code>write</code> that can read and write <code></code>.bin or <code></code>.fits files in MATLAB. The source of these mex routines are located in sub-folder <code>mex</code>. If <code>mex</code> is found in the system, this mex routines will be compiled automatically in the <code>mex</code> subfolder of the compiling folder. If it doesn't get compiled, please goto the <code>mex</code> subfolder in the source folder and type ./compile.sh to compile them. Copy <code>write.mexa64</code> and <code>read.mexa64</code> into a folder that is in your matlab path, such as $HOME/matlab. The usage in MATLAB is as follows:</p>
<pre class="fragment">   cle=read('Res_1'); 
or cle=read('Res_1.bin'); 
or cle=read('Res_1.bin.gz');
   each wil try to read Res_1.bin or Res_1.bin.gz 
   
   write(cle,'Res_1');     will write the data to Res_1.bin.gz;
   write(cle,'Res_1.bin'); will write the data to Res_1.bin without compression.</pre><p>If there is any problem in compling read.c and write.c, there are two matlab scripts in the scripts folder, readbin.m and writebin.m, that have most of functionality of read.c, write.c albeit a bit slower and cannot handle compressed files conveniently.</p>
<p>The data are saved to the bin files in a moduler way. For a simple matrix (like double matrix or cell matrix), we first write a magic number (4 byte unsigned int) representing the data type, and then x and y dimension (two 8 byte unsigned ints), and finally the data itself (if it is cell, recursively write the data contained in the cell with the same method).</p>
<p>Each block of data may optionally be proceeded with a metadata header that describes the data, for example, the sampling of a <a class="el" href="structloc__t.html" title="Struct for coordinates like plocs, xloc, aloc etc.">loc_t</a> grid. The surf OPD contains header information about the sampling, origin and height of the OPD array.</p>
<h1><a class="anchor" id="sect-idl"></a>
Reading Results in IDL</h1>
<p>There are two idl scripts in the sub-folder <code>script</code>. They are readbin.pro for reading bin files, and writebin.pro for writing bin files.</p>
<h1><a class="anchor" id="sect-interpret"></a>
Result Format</h1>
<p>There will be several files created during simulation in the result folder. The number after underscore _ is the seed. For example, with seed 1 the following files are produced. Read in these files using provided mex function <code>read</code> in MATLAB. Notice that the suffix .bin or .bin.gz has been removed. You do not need to add the suffix when use <code>read</code>.</p>
<ul>
<li><code>Res_1:</code> A binary file containing a cell array that include the main results. i.e. res=read('Res_1');<ul>
<li><code>res{1}</code> contains the open loop wavefront variance (WFV in units of <img class="formulaInl" alt="$m^2$" src="form_0.png"/>) in row vectors. The rows are<ul>
<li>Piston removed WFV</li>
<li>WFV in tip/tilt modes</li>
<li>Piston/tip/tilt removed WFV</li>
</ul>
</li>
<li><code>res{2}</code> contains the residual wavefront variance after the tomography phase screen is directly applied as the correction in open loop mode. Empty if evl.tomo is zero.</li>
<li><code>res{3}</code> contains the closed loop wavefront variance in row vectors. The rows are<ul>
<li>Piston removed WFV</li>
<li>WVF in tip/tilt modes</li>
<li>Piston/tip/tilt removed WFV</li>
</ul>
</li>
<li><code>res{4}</code> (Only in split tomography) contains the closed loop wavefront variance. The rows are<ul>
<li>WFV in LGS contains modes</li>
<li>WFV in NGS Tip/Tilt modes</li>
<li>WFV in NGS modes (includeing Tip/Tilt and additional modes controlled by NGS (On-Instrument WFS)</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><code>Resolep_1:</code> Open loop wavefront variance for each science field point. Each cell represent a science field point. The format is similar to res{1} above.</li>
</ul>
<ul>
<li><code>Resolmp_1:</code> Open loop wavefront Zernike (not normalized wrt radius) modes defined on not-normalized coordinate on the aperture. The format is similar as <code>Resolep_1</code> </li>
</ul>
<ul>
<li><code>Resclep_1:</code> Closed loop wavefront variance for each science field point, in the same format as Resolep_1</li>
</ul>
<ul>
<li><code>Resclmp_1:</code> Close loop wavefront Zernike modes, in the same format as Resolmp_1</li>
</ul>
<ul>
<li><code>Resclemp_1:</code> (Only in split tomography) LGS/TT/NGS mode wavefront error for each direction.</li>
</ul>
<ul>
<li><code>RescleNGSm_1:</code> (Only in split tomography) contains a row vector array of either the residual NGS modes (in radian like unit) or the applied NGS mode correction if ideal NGS mode correction is made. Mainly used to save the ideal NGS modes applied in skycoverage pre-simulation.</li>
</ul>
<ul>
<li><code>maos_975.conf:</code> The final effective arrays of the configurations for MAOS run with PID 975. Can be used to reproduce the simulation or check the configurations. Lines begin with # are defaults configurations while the rest have been overriden.</li>
</ul>
<ul>
<li><code>sanea_sim_1:</code> When wavefront sensors are running in physical optics mode, the average gradinet measurement error for that wavefront sensor is saved (in order) in a cell in this file. Each cell is a column vector with elements twice the number of subaperture. The first half is for x (or radial) gradient, and the second half is for y (or azimuthal) gradient. They are in units of <img class="formulaInl" alt="$rad^2$" src="form_1.png"/>.</li>
</ul>
<ul>
<li><code>evlpsfcl_1:</code> When evl.psfmean is 1, contains the time averaged science closed loop psf. if is a cell array of <img class="formulaInl" alt="$n_{wvl}\times n_{evl}$" src="form_2.png"/>. Each cell contains a center cut of the science PSF.</li>
</ul>
<ul>
<li><code>evlpsfdl_1:</code> diffraction limited, PSF.</li>
</ul>
<ul>
<li><code>evlpsfol_1:</code> frame and field averaged open loop science PSF.</li>
</ul>
<ul>
<li><code>evlpsfhist_1_ievlx:</code> When evl.psfhist is 1, each of these files contains the time history of the complex PSF of evaluation direction x.</li>
</ul>
<ul>
<li><code>Resuptcmd_1:</code> Each cell contains the uplink tip/tilt command (only none empty for LGS WFS) history in unit of radian.</li>
</ul>
<ul>
<li><code>Resupterr_1:</code> Each cell contains the uplink tip/tilt error history in unit of radian. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
