<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>maos-0.9.3: lib/cmat.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">maos-0.9.3</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('cmat_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>lib/cmat.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>The following are functions that are only useful for cmat.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2725611a27bba450e4b17592425a0b3b"></a><!-- doxytag: member="cmat.c::USE_COMPLEX" ref="a2725611a27bba450e4b17592425a0b3b" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>USE_COMPLEX</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a8fa3c4cef9c249597bb27c189bfa70e3">cmpcpy</a>(A, B, S)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to do copying  <a href="#a8fa3c4cef9c249597bb27c189bfa70e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a146b15da10eac68bacd2e58603410b6b">RA2XY</a>(A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to convert r/a to x/y  <a href="#a146b15da10eac68bacd2e58603410b6b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a265c841095aea2a1650af702ac1bb91a">XY2RA</a>(A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to convert x/y to r/a  <a href="#a265c841095aea2a1650af702ac1bb91a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab7067b7289792bf866cf3316109458cf"></a><!-- doxytag: member="cmat.c::DO_LOOP" ref="ab7067b7289792bf866cf3316109458cf" args="(AFTER, CMD)" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DO_LOOP</b>(AFTER, CMD)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab7067b7289792bf866cf3316109458cf"></a><!-- doxytag: member="cmat.c::DO_LOOP" ref="ab7067b7289792bf866cf3316109458cf" args="(AFTER, CMD)" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DO_LOOP</b>(AFTER, CMD)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67c744661e8990a7ad32f86e4e7fc497"></a><!-- doxytag: member="cmat.c::DO_COPY2" ref="a67c744661e8990a7ad32f86e4e7fc497" args="(CCMD)" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DO_COPY2</b>(CCMD)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a7d012cdba278344ecbc2714cf63ffaf7">cmaxabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">compute maximum of abs of the numbers  <a href="#a7d012cdba278344ecbc2714cf63ffaf7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#af3b5c3e441cfaf655561d1c2d37f145a">cminabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">compute minimum of abs of the numbers  <a href="#af3b5c3e441cfaf655561d1c2d37f145a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a05e65746042e26bd360d6e7ce2dca640">csumabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">compute sum of abs of the numbers  <a href="#a05e65746042e26bd360d6e7ce2dca640"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#ab3e6e6b97e215298f0ca1dfe33ed5ea4">ccwm3</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, const <a class="el" href="structcmat.html">cmat</a> *__restrict C)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component-wise multiply of three matrices.  <a href="#ab3e6e6b97e215298f0ca1dfe33ed5ea4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#aa2ad3805ad3d8fefee23c1cc5ccc7f3a">ccwm2</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, const double alpha)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component-wise multiply A=A.  <a href="#aa2ad3805ad3d8fefee23c1cc5ccc7f3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a730459c701f66a9401f27004d391e17b">ccwmcol</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Component-wise multiply each column of A with B A(:,i)=A(:,i).  <a href="#a730459c701f66a9401f27004d391e17b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#af78cb1aa7d4f09ccc1b0f1f8c651d60d">ccwm3col</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict W, const <a class="el" href="structcmat.html">cmat</a> *__restrict B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component wise multiply of 2d complex matrix A,W and 1d vector B.  <a href="#af78cb1aa7d4f09ccc1b0f1f8c651d60d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#ab92cb4abd5a13f577de29296d258700a">ccwmrow</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Component wise multiply each row of A with B.  <a href="#ab92cb4abd5a13f577de29296d258700a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a5c32c8eba37bc5cbf211c442165424da">ccwmcol2</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const dcomplex *__restrict B1, const double wt1, const dcomplex *__restrict B2, const double wt2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component-wise multiply of columns of A with combination of B1 and B2: A(:,i)=A(:,i)*(B1*wt1+B2*wt2);  <a href="#a5c32c8eba37bc5cbf211c442165424da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a833ef9ff24c76c714ef5b56079561256">ccwmrow2</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const dcomplex *__restrict B1, const double wt1, const dcomplex *__restrict B2, const double wt2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component-wise multiply of rows of A with combination of B1 and B2: A(i,:)=A(i,:).  <a href="#a833ef9ff24c76c714ef5b56079561256"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a26410f22086f4e0868e3e47587b15456">ccwmc</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, const double alpha)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component-wise multiply A with conjugate of B: A=A.  <a href="#a26410f22086f4e0868e3e47587b15456"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a37ae61b57dc15892d3e56cffeefa010b">ccwmd</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structdmat.html">dmat</a> *__restrict B, const double alpha)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">component multiply dmat A with cmat B.  <a href="#a37ae61b57dc15892d3e56cffeefa010b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a197b27b939cdc286cbb170addc58a926">cembed_wvf</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const double *opd, const double *amp, const int nopdx, const int nopdy, const double wvl, const double theta)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">reshape amp.  <a href="#a197b27b939cdc286cbb170addc58a926"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a7d5e997f3f896ee53fa48a683c50d1db">sq2cpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">do a modules square and copy to real part of output  <a href="#a7d5e997f3f896ee53fa48a683c50d1db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#af3bf0c08af81518daf8cf1b2c5a10439">realcpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the real part.  <a href="#af3bf0c08af81518daf8cf1b2c5a10439"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#ae8f7121f498b7d4912301cf180680637">abscpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the absolute value to output.  <a href="#ae8f7121f498b7d4912301cf180680637"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a29ba177902f8b17254b0798fb68d123c">cembed</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, const double theta, CEMBED flag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Embed array B into A with rotation theta CW.  <a href="#a29ba177902f8b17254b0798fb68d123c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4ec01807ddaeb76898f74477ff10818"></a><!-- doxytag: member="cmat.c::cembedd" ref="ab4ec01807ddaeb76898f74477ff10818" args="(cmat *__restrict A, dmat *__restrict B, const double theta)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>cembedd</b> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, <a class="el" href="structdmat.html">dmat</a> *__restrict B, const double theta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a1db8c9599e79486fd42d874338a82562">cembedscaleout</a> (<a class="el" href="structcmat.html">cmat</a> *__restrict A, const <a class="el" href="structcmat.html">cmat</a> *B, double xoutscale, double youtscale, const double theta, CEMBED flag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">rotate (around fft center: (nx/2,ny/2)) CCW theta and embed in into A.  <a href="#a1db8c9599e79486fd42d874338a82562"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a46bb33d971edf897be0a4ac84b7f7fd8">ccpcorner</a> (<a class="el" href="structcmat.html">cmat</a> *A, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, CEMBED flag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">copy and embed/crop psfin into psfout  <a href="#a46bb33d971edf897be0a4ac84b7f7fd8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a23f317cbb6e5cad3b80acefd960f7c7f">cabs2toreal</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Put abs square of each element into its realpart.  <a href="#a23f317cbb6e5cad3b80acefd960f7c7f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a952faac0b7598955f5d6108d66222707">cabstoreal</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Put abs of each elemnt into its realpart.  <a href="#a952faac0b7598955f5d6108d66222707"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#aa39c2558e25a70acf9d7cff351801624">ccpd</a> (<a class="el" href="structcmat.html">cmat</a> **__restrict A0, const <a class="el" href="structdmat.html">dmat</a> *__restrict B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a dmat into real part of cmat.  <a href="#aa39c2558e25a70acf9d7cff351801624"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a3aff8e63792a547a616e55ceab8259f1">creal2d</a> (<a class="el" href="structdmat.html">dmat</a> **__restrict A0, double alpha, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, double beta)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy real part of a cmat to dmat with optional scaling: A0=A0.  <a href="#a3aff8e63792a547a616e55ceab8259f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#a8922c4474048f514d355ab01c48e5a76">cabs22d</a> (<a class="el" href="structdmat.html">dmat</a> **__restrict A0, double alpha, const <a class="el" href="structcmat.html">cmat</a> *__restrict B, double beta)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy abs squared of a cmat to dmat with optional scaling: A0=A0*alpha+abs(B).  <a href="#a8922c4474048f514d355ab01c48e5a76"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat_8c.html#af912fcd3192a45180c528f075f1d0988">ctilt</a> (<a class="el" href="structcmat.html">cmat</a> *otf, double sx, double sy, int pinct)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Tilt the otf to make the image shift.  <a href="#af912fcd3192a45180c528f075f1d0988"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The following are functions that are only useful for cmat. </p>
<p>notice that fma and modf are slower than native functions. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8fa3c4cef9c249597bb27c189bfa70e3"></a><!-- doxytag: member="cmat.c::cmpcpy" ref="a8fa3c4cef9c249597bb27c189bfa70e3" args="(A, B, S)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cmpcpy</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">S&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>macro to do copying </p>

</div>
</div>
<a class="anchor" id="a146b15da10eac68bacd2e58603410b6b"></a><!-- doxytag: member="cmat.c::RA2XY" ref="a146b15da10eac68bacd2e58603410b6b" args="(A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RA2XY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>macro to convert r/a to x/y </p>

</div>
</div>
<a class="anchor" id="a265c841095aea2a1650af702ac1bb91a"></a><!-- doxytag: member="cmat.c::XY2RA" ref="a265c841095aea2a1650af702ac1bb91a" args="(A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XY2RA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>macro to convert x/y to r/a </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7d012cdba278344ecbc2714cf63ffaf7"></a><!-- doxytag: member="cmat.c::cmaxabs" ref="a7d012cdba278344ecbc2714cf63ffaf7" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cmaxabs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>compute maximum of abs of the numbers </p>

</div>
</div>
<a class="anchor" id="af3b5c3e441cfaf655561d1c2d37f145a"></a><!-- doxytag: member="cmat.c::cminabs" ref="af3b5c3e441cfaf655561d1c2d37f145a" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cminabs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>compute minimum of abs of the numbers </p>

</div>
</div>
<a class="anchor" id="a05e65746042e26bd360d6e7ce2dca640"></a><!-- doxytag: member="cmat.c::csumabs" ref="a05e65746042e26bd360d6e7ce2dca640" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double csumabs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>compute sum of abs of the numbers </p>

</div>
</div>
<a class="anchor" id="ab3e6e6b97e215298f0ca1dfe33ed5ea4"></a><!-- doxytag: member="cmat.c::ccwm3" ref="ab3e6e6b97e215298f0ca1dfe33ed5ea4" args="(cmat *__restrict A, const cmat *__restrict B, const cmat *__restrict C)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component-wise multiply of three matrices. </p>
<p>A=A.*B.*C </p>

</div>
</div>
<a class="anchor" id="aa2ad3805ad3d8fefee23c1cc5ccc7f3a"></a><!-- doxytag: member="cmat.c::ccwm2" ref="aa2ad3805ad3d8fefee23c1cc5ccc7f3a" args="(cmat *__restrict A, const cmat *__restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component-wise multiply A=A. </p>
<p>*B*alpha </p>

</div>
</div>
<a class="anchor" id="a730459c701f66a9401f27004d391e17b"></a><!-- doxytag: member="cmat.c::ccwmcol" ref="a730459c701f66a9401f27004d391e17b" args="(cmat *__restrict A, const cmat *__restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmcol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Component-wise multiply each column of A with B A(:,i)=A(:,i). </p>
<p>*B; </p>

</div>
</div>
<a class="anchor" id="af78cb1aa7d4f09ccc1b0f1f8c651d60d"></a><!-- doxytag: member="cmat.c::ccwm3col" ref="af78cb1aa7d4f09ccc1b0f1f8c651d60d" args="(cmat *__restrict A, const cmat *__restrict W, const cmat *__restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm3col </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component wise multiply of 2d complex matrix A,W and 1d vector B. </p>
<p>A(:,i)=A(:,i).*W(:,i).*B; </p>

</div>
</div>
<a class="anchor" id="ab92cb4abd5a13f577de29296d258700a"></a><!-- doxytag: member="cmat.c::ccwmrow" ref="ab92cb4abd5a13f577de29296d258700a" args="(cmat *__restrict A, const cmat *__restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmrow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Component wise multiply each row of A with B. </p>
<p>A(i,:)=A(i,:)*B </p>

</div>
</div>
<a class="anchor" id="a5c32c8eba37bc5cbf211c442165424da"></a><!-- doxytag: member="cmat.c::ccwmcol2" ref="a5c32c8eba37bc5cbf211c442165424da" args="(cmat *__restrict A, const dcomplex *__restrict B1, const double wt1, const dcomplex *__restrict B2, const double wt2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmcol2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *__restrict&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *__restrict&#160;</td>
          <td class="paramname"><em>B2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wt2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component-wise multiply of columns of A with combination of B1 and B2: A(:,i)=A(:,i)*(B1*wt1+B2*wt2); </p>

</div>
</div>
<a class="anchor" id="a833ef9ff24c76c714ef5b56079561256"></a><!-- doxytag: member="cmat.c::ccwmrow2" ref="a833ef9ff24c76c714ef5b56079561256" args="(cmat *__restrict A, const dcomplex *__restrict B1, const double wt1, const dcomplex *__restrict B2, const double wt2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmrow2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *__restrict&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *__restrict&#160;</td>
          <td class="paramname"><em>B2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wt2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component-wise multiply of rows of A with combination of B1 and B2: A(i,:)=A(i,:). </p>
<p>*(B1*wt1+B2*wt2); </p>

</div>
</div>
<a class="anchor" id="a26410f22086f4e0868e3e47587b15456"></a><!-- doxytag: member="cmat.c::ccwmc" ref="a26410f22086f4e0868e3e47587b15456" args="(cmat *__restrict A, const cmat *__restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component-wise multiply A with conjugate of B: A=A. </p>
<p>*conj(B)*alpha; </p>

</div>
</div>
<a class="anchor" id="a37ae61b57dc15892d3e56cffeefa010b"></a><!-- doxytag: member="cmat.c::ccwmd" ref="a37ae61b57dc15892d3e56cffeefa010b" args="(cmat *__restrict A, const dmat *__restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>component multiply dmat A with cmat B. </p>
<p>A=A.*B; </p>

</div>
</div>
<a class="anchor" id="a197b27b939cdc286cbb170addc58a926"></a><!-- doxytag: member="cmat.c::cembed_wvf" ref="a197b27b939cdc286cbb170addc58a926" args="(cmat *__restrict A, const double *opd, const double *amp, const int nopdx, const int nopdy, const double wvl, const double theta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembed_wvf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>opd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nopdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nopdy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>wvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>reshape amp. </p>
<p>*exp(-2*pi/lambda*opd) into square and embed into center of A, with optional rotation of theta CW.</p>
<p>benchmark: embed 32x32 into 64x64, without rotation takes 0.161 ms. with rotation takes 0.330 ms. </p>

</div>
</div>
<a class="anchor" id="a7d5e997f3f896ee53fa48a683c50d1db"></a><!-- doxytag: member="cmat.c::sq2cpy" ref="a7d5e997f3f896ee53fa48a683c50d1db" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sq2cpy </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>do a modules square and copy to real part of output </p>

</div>
</div>
<a class="anchor" id="af3bf0c08af81518daf8cf1b2c5a10439"></a><!-- doxytag: member="cmat.c::realcpy" ref="af3bf0c08af81518daf8cf1b2c5a10439" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void realcpy </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy the real part. </p>

</div>
</div>
<a class="anchor" id="ae8f7121f498b7d4912301cf180680637"></a><!-- doxytag: member="cmat.c::abscpy" ref="ae8f7121f498b7d4912301cf180680637" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void abscpy </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy the absolute value to output. </p>

</div>
</div>
<a class="anchor" id="a29ba177902f8b17254b0798fb68d123c"></a><!-- doxytag: member="cmat.c::cembed" ref="a29ba177902f8b17254b0798fb68d123c" args="(cmat *__restrict A, const cmat *__restrict B, const double theta, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Embed array B into A with rotation theta CW. </p>
<p>Current version, preferred </p>

</div>
</div>
<a class="anchor" id="a1db8c9599e79486fd42d874338a82562"></a><!-- doxytag: member="cmat.c::cembedscaleout" ref="a1db8c9599e79486fd42d874338a82562" args="(cmat *__restrict A, const cmat *B, double xoutscale, double youtscale, const double theta, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembedscaleout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xoutscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>youtscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>rotate (around fft center: (nx/2,ny/2)) CCW theta and embed in into A. </p>

</div>
</div>
<a class="anchor" id="a46bb33d971edf897be0a4ac84b7f7fd8"></a><!-- doxytag: member="cmat.c::ccpcorner" ref="a46bb33d971edf897be0a4ac84b7f7fd8" args="(cmat *A, const cmat *__restrict B, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccpcorner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>copy and embed/crop psfin into psfout </p>
<div class="fragment"><pre class="fragment">
   4 * * 3
   * * * *
   * * * *
   2 * * 1
   </pre></div><p> to </p>
<div class="fragment"><pre class="fragment">
   4 * * * 3
   * * * * *
   * * * * *
   * * * * *
   2 * * * 1 
   </pre></div><p> } </p>

</div>
</div>
<a class="anchor" id="a23f317cbb6e5cad3b80acefd960f7c7f"></a><!-- doxytag: member="cmat.c::cabs2toreal" ref="a23f317cbb6e5cad3b80acefd960f7c7f" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabs2toreal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Put abs square of each element into its realpart. </p>
<p>A=abs(A).^2; </p>

</div>
</div>
<a class="anchor" id="a952faac0b7598955f5d6108d66222707"></a><!-- doxytag: member="cmat.c::cabstoreal" ref="a952faac0b7598955f5d6108d66222707" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabstoreal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Put abs of each elemnt into its realpart. </p>
<p>A=abs(A); </p>

</div>
</div>
<a class="anchor" id="aa39c2558e25a70acf9d7cff351801624"></a><!-- doxytag: member="cmat.c::ccpd" ref="aa39c2558e25a70acf9d7cff351801624" args="(cmat **__restrict A0, const dmat *__restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccpd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> **__restrict&#160;</td>
          <td class="paramname"><em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy a dmat into real part of cmat. </p>

</div>
</div>
<a class="anchor" id="a3aff8e63792a547a616e55ceab8259f1"></a><!-- doxytag: member="cmat.c::creal2d" ref="a3aff8e63792a547a616e55ceab8259f1" args="(dmat **__restrict A0, double alpha, const cmat *__restrict B, double beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void creal2d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **__restrict&#160;</td>
          <td class="paramname"><em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy real part of a cmat to dmat with optional scaling: A0=A0. </p>
<p>*alpha+real(B)*beta </p>

</div>
</div>
<a class="anchor" id="a8922c4474048f514d355ab01c48e5a76"></a><!-- doxytag: member="cmat.c::cabs22d" ref="a8922c4474048f514d355ab01c48e5a76" args="(dmat **__restrict A0, double alpha, const cmat *__restrict B, double beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabs22d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **__restrict&#160;</td>
          <td class="paramname"><em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *__restrict&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy abs squared of a cmat to dmat with optional scaling: A0=A0*alpha+abs(B). </p>
<p>^2*beta; </p>

</div>
</div>
<a class="anchor" id="af912fcd3192a45180c528f075f1d0988"></a><!-- doxytag: member="cmat.c::ctilt" ref="af912fcd3192a45180c528f075f1d0988" args="(cmat *otf, double sx, double sy, int pinct)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctilt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&#160;</td>
          <td class="paramname"><em>otf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pinct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Tilt the otf to make the image shift. </p>
<p>apply exp(-2*pi*sx/nx)*exp(-2*pi*sy/ny) to otf to move the image sx, sy are shifts in terms of pixel. sx/nx is equivalent to sx*dtheta*du. pinct=1: peak is in center pinct=0: peak is in corner </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="cmat_8c.html">cmat.c</a>      </li>
      <li class="footer">Generated on Fri Sep 23 2011 10:43:45 for maos-0.9.3 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>

</body>
</html>
