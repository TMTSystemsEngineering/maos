<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>maos-0.7.5: lib/cmat_extra.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/cmat_extra.c File Reference</h1>The following are functions that are only useful for <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#8fa3c4cef9c249597bb27c189bfa70e3">cmpcpy</a>(A, B, S)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">macro to do copying  <a href="#8fa3c4cef9c249597bb27c189bfa70e3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#146b15da10eac68bacd2e58603410b6b">RA2XY</a>(A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">macro to convert r/a to x/y  <a href="#146b15da10eac68bacd2e58603410b6b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#265c841095aea2a1650af702ac1bb91a">XY2RA</a>(A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">macro to convert x/y to r/a  <a href="#265c841095aea2a1650af702ac1bb91a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b7067b7289792bf866cf3316109458cf"></a><!-- doxytag: member="cmat_extra.c::DO_LOOP" ref="b7067b7289792bf866cf3316109458cf" args="(AFTER, CMD)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>DO_LOOP</b>(AFTER, CMD)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b7067b7289792bf866cf3316109458cf"></a><!-- doxytag: member="cmat_extra.c::DO_LOOP" ref="b7067b7289792bf866cf3316109458cf" args="(AFTER, CMD)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>DO_LOOP</b>(AFTER, CMD)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="67c744661e8990a7ad32f86e4e7fc497"></a><!-- doxytag: member="cmat_extra.c::DO_COPY2" ref="67c744661e8990a7ad32f86e4e7fc497" args="(CCMD)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>DO_COPY2</b>(CCMD)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#7d012cdba278344ecbc2714cf63ffaf7">cmaxabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">compute maximum of abs of the numbers  <a href="#7d012cdba278344ecbc2714cf63ffaf7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#f3b5c3e441cfaf655561d1c2d37f145a">cminabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">compute minimum of abs of the numbers  <a href="#f3b5c3e441cfaf655561d1c2d37f145a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#05e65746042e26bd360d6e7ce2dca640">csumabs</a> (const <a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">compute sum of abs of the numbers  <a href="#05e65746042e26bd360d6e7ce2dca640"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#128c1f2e5ec78e2d83e7de64982b3f34">ccwm3</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B, const <a class="el" href="structcmat.html">cmat</a> *restrict C)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component-wise multiply of three matrices.  <a href="#128c1f2e5ec78e2d83e7de64982b3f34"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#18ab9f6533541cbd1009203d12a5c1ac">ccwm2</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B, const double alpha)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component-wise multiply A=A.  <a href="#18ab9f6533541cbd1009203d12a5c1ac"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#8415fb720710c12beb34ef65e4c15bc5">ccwmcol</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Component-wise multiply each column of A with B A(:,i)=A(:,i).  <a href="#8415fb720710c12beb34ef65e4c15bc5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#c537b0ad1d3d03883f4a5979e96bf761">ccwm3col</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict W, const <a class="el" href="structcmat.html">cmat</a> *restrict B)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component wise multiply of 2d complex matrix A,W and 1d vector B.  <a href="#c537b0ad1d3d03883f4a5979e96bf761"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#a512f3768a7155aa2fed40113f15cfd7">ccwmrow</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Component wise multiply each row of A with B.  <a href="#a512f3768a7155aa2fed40113f15cfd7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#74c60b022d7693e0973273b9651f4505">ccwmcol2</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const dcomplex *restrict B1, const double wt1, const dcomplex *restrict B2, const double wt2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component-wise multiply of columns of A with combination of B1 and B2: A(:,i)=A(:,i)*(B1*wt1+B2*wt2);  <a href="#74c60b022d7693e0973273b9651f4505"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#86f92e8ac1855f1c25f2c2780ee00eb7">ccwmrow2</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const dcomplex *restrict B1, const double wt1, const dcomplex *restrict B2, const double wt2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component-wise multiply of rows of A with combination of B1 and B2: A(i,:)=A(i,:).  <a href="#86f92e8ac1855f1c25f2c2780ee00eb7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#cb122cb49f6760f7ef17133f64d24304">ccwmc</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B, const double alpha)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component-wise multiply A with conjugate of B: A=A.  <a href="#cb122cb49f6760f7ef17133f64d24304"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#42e5c392b9c07427312ef94f0e55ea33">ccwmd</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structdmat.html">dmat</a> *restrict B, const double alpha)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">component multiply <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> A with <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> B.  <a href="#42e5c392b9c07427312ef94f0e55ea33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#b7a468d8dccd7e9095745af0367d51c6">cembed_wvf</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const double *opd, const double *amp, const int nopdx, const int nopdy, const double wvl, const double theta)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">reshape amp.  <a href="#b7a468d8dccd7e9095745af0367d51c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#7d5e997f3f896ee53fa48a683c50d1db">sq2cpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">do a modules square and copy to real part of output  <a href="#7d5e997f3f896ee53fa48a683c50d1db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#f3bf0c08af81518daf8cf1b2c5a10439">realcpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy the real part.  <a href="#f3bf0c08af81518daf8cf1b2c5a10439"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#e8f7121f498b7d4912301cf180680637">abscpy</a> (dcomplex *out, const dcomplex *in, const size_t length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy the absolute value to output.  <a href="#e8f7121f498b7d4912301cf180680637"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#772387b5274cd5438d1612a1fd58d8d2">cembed</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *restrict B, const double theta, CEMBED flag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Embed array B into A with rotation theta CW.  <a href="#772387b5274cd5438d1612a1fd58d8d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#6f86acfdccdc2c5a1c3d02d4ae33ac15">cembedscaleout</a> (<a class="el" href="structcmat.html">cmat</a> *restrict A, const <a class="el" href="structcmat.html">cmat</a> *B, double xoutscale, double youtscale, const double theta, CEMBED flag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">rotate (around fft center: (nx/2,ny/2)) CCW theta and embed in into A.  <a href="#6f86acfdccdc2c5a1c3d02d4ae33ac15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#b5a692d8dd9656bde4d9fe988d26695a">ccpcorner</a> (<a class="el" href="structcmat.html">cmat</a> *A, const <a class="el" href="structcmat.html">cmat</a> *restrict B, CEMBED flag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">copy and embed/crop psfin into psfout  <a href="#b5a692d8dd9656bde4d9fe988d26695a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#23f317cbb6e5cad3b80acefd960f7c7f">cabs2toreal</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put abs square of each element into its realpart.  <a href="#23f317cbb6e5cad3b80acefd960f7c7f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#952faac0b7598955f5d6108d66222707">cabstoreal</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put abs of each elemnt into its realpart.  <a href="#952faac0b7598955f5d6108d66222707"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#4ff6717c6a0f3919c71a2dc6fde5aae8">ccpd</a> (<a class="el" href="structcmat.html">cmat</a> **restrict A0, const <a class="el" href="structdmat.html">dmat</a> *restrict B)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy a <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> into real part of <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>.  <a href="#4ff6717c6a0f3919c71a2dc6fde5aae8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#b2baa26f7bd8861ab342eee97889522d">creal2d</a> (<a class="el" href="structdmat.html">dmat</a> **restrict A0, double alpha, const <a class="el" href="structcmat.html">cmat</a> *restrict B, double beta)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy real part of a <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> to <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> with optional scaling: A0=A0.  <a href="#b2baa26f7bd8861ab342eee97889522d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#d50c3f29262e58d4032225e69edc892f">cabs22d</a> (<a class="el" href="structdmat.html">dmat</a> **restrict A0, double alpha, const <a class="el" href="structcmat.html">cmat</a> *restrict B, double beta)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy abs squared of a <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> to <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> with optional scaling: A0=A0*alpha+abs(B).  <a href="#d50c3f29262e58d4032225e69edc892f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmat__extra_8c.html#f912fcd3192a45180c528f075f1d0988">ctilt</a> (<a class="el" href="structcmat.html">cmat</a> *otf, double sx, double sy, int pinct)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tilt the otf to make the image shift.  <a href="#f912fcd3192a45180c528f075f1d0988"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The following are functions that are only useful for <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>. 
<p>
notice that fma and modf are slower than native functions. <hr><h2>Define Documentation</h2>
<a class="anchor" name="8fa3c4cef9c249597bb27c189bfa70e3"></a><!-- doxytag: member="cmat_extra.c::cmpcpy" ref="8fa3c4cef9c249597bb27c189bfa70e3" args="(A, B, S)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define cmpcpy          </td>
          <td>(</td>
          <td class="paramtype">A,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">B,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">S&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
macro to do copying 
<p>

</div>
</div><p>
<a class="anchor" name="146b15da10eac68bacd2e58603410b6b"></a><!-- doxytag: member="cmat_extra.c::RA2XY" ref="146b15da10eac68bacd2e58603410b6b" args="(A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RA2XY          </td>
          <td>(</td>
          <td class="paramtype">A&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
macro to convert r/a to x/y 
<p>

</div>
</div><p>
<a class="anchor" name="265c841095aea2a1650af702ac1bb91a"></a><!-- doxytag: member="cmat_extra.c::XY2RA" ref="265c841095aea2a1650af702ac1bb91a" args="(A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XY2RA          </td>
          <td>(</td>
          <td class="paramtype">A&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
macro to convert x/y to r/a 
<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7d012cdba278344ecbc2714cf63ffaf7"></a><!-- doxytag: member="cmat_extra.c::cmaxabs" ref="7d012cdba278344ecbc2714cf63ffaf7" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cmaxabs           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
compute maximum of abs of the numbers 
<p>

</div>
</div><p>
<a class="anchor" name="f3b5c3e441cfaf655561d1c2d37f145a"></a><!-- doxytag: member="cmat_extra.c::cminabs" ref="f3b5c3e441cfaf655561d1c2d37f145a" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cminabs           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
compute minimum of abs of the numbers 
<p>

</div>
</div><p>
<a class="anchor" name="05e65746042e26bd360d6e7ce2dca640"></a><!-- doxytag: member="cmat_extra.c::csumabs" ref="05e65746042e26bd360d6e7ce2dca640" args="(const cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double csumabs           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
compute sum of abs of the numbers 
<p>

</div>
</div><p>
<a class="anchor" name="128c1f2e5ec78e2d83e7de64982b3f34"></a><!-- doxytag: member="cmat_extra.c::ccwm3" ref="128c1f2e5ec78e2d83e7de64982b3f34" args="(cmat *restrict A, const cmat *restrict B, const cmat *restrict C)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm3           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>C</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component-wise multiply of three matrices. 
<p>
A=A.*B.*C 
</div>
</div><p>
<a class="anchor" name="18ab9f6533541cbd1009203d12a5c1ac"></a><!-- doxytag: member="cmat_extra.c::ccwm2" ref="18ab9f6533541cbd1009203d12a5c1ac" args="(cmat *restrict A, const cmat *restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component-wise multiply A=A. 
<p>
*B*alpha 
</div>
</div><p>
<a class="anchor" name="8415fb720710c12beb34ef65e4c15bc5"></a><!-- doxytag: member="cmat_extra.c::ccwmcol" ref="8415fb720710c12beb34ef65e4c15bc5" args="(cmat *restrict A, const cmat *restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmcol           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Component-wise multiply each column of A with B A(:,i)=A(:,i). 
<p>
*B; 
</div>
</div><p>
<a class="anchor" name="c537b0ad1d3d03883f4a5979e96bf761"></a><!-- doxytag: member="cmat_extra.c::ccwm3col" ref="c537b0ad1d3d03883f4a5979e96bf761" args="(cmat *restrict A, const cmat *restrict W, const cmat *restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwm3col           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component wise multiply of 2d complex matrix A,W and 1d vector B. 
<p>
A(:,i)=A(:,i).*W(:,i).*B; 
</div>
</div><p>
<a class="anchor" name="a512f3768a7155aa2fed40113f15cfd7"></a><!-- doxytag: member="cmat_extra.c::ccwmrow" ref="a512f3768a7155aa2fed40113f15cfd7" args="(cmat *restrict A, const cmat *restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmrow           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Component wise multiply each row of A with B. 
<p>
A(i,:)=A(i,:)*B 
</div>
</div><p>
<a class="anchor" name="74c60b022d7693e0973273b9651f4505"></a><!-- doxytag: member="cmat_extra.c::ccwmcol2" ref="74c60b022d7693e0973273b9651f4505" args="(cmat *restrict A, const dcomplex *restrict B1, const double wt1, const dcomplex *restrict B2, const double wt2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmcol2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>wt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>B2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>wt2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component-wise multiply of columns of A with combination of B1 and B2: A(:,i)=A(:,i)*(B1*wt1+B2*wt2); 
<p>

</div>
</div><p>
<a class="anchor" name="86f92e8ac1855f1c25f2c2780ee00eb7"></a><!-- doxytag: member="cmat_extra.c::ccwmrow2" ref="86f92e8ac1855f1c25f2c2780ee00eb7" args="(cmat *restrict A, const dcomplex *restrict B1, const double wt1, const dcomplex *restrict B2, const double wt2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmrow2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>wt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>B2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>wt2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component-wise multiply of rows of A with combination of B1 and B2: A(i,:)=A(i,:). 
<p>
*(B1*wt1+B2*wt2); 
</div>
</div><p>
<a class="anchor" name="cb122cb49f6760f7ef17133f64d24304"></a><!-- doxytag: member="cmat_extra.c::ccwmc" ref="cb122cb49f6760f7ef17133f64d24304" args="(cmat *restrict A, const cmat *restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmc           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component-wise multiply A with conjugate of B: A=A. 
<p>
*conj(B)*alpha; 
</div>
</div><p>
<a class="anchor" name="42e5c392b9c07427312ef94f0e55ea33"></a><!-- doxytag: member="cmat_extra.c::ccwmd" ref="42e5c392b9c07427312ef94f0e55ea33" args="(cmat *restrict A, const dmat *restrict B, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccwmd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
component multiply <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> A with <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> B. 
<p>
A=A.*B; 
</div>
</div><p>
<a class="anchor" name="b7a468d8dccd7e9095745af0367d51c6"></a><!-- doxytag: member="cmat_extra.c::cembed_wvf" ref="b7a468d8dccd7e9095745af0367d51c6" args="(cmat *restrict A, const double *opd, const double *amp, const int nopdx, const int nopdy, const double wvl, const double theta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembed_wvf           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>opd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>nopdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>nopdy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>wvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>theta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
reshape amp. 
<p>
*exp(-2*pi/lambda*opd) into square and embed into center of A, with optional rotation of theta CW.<p>
benchmark: embed 32x32 into 64x64, without rotation takes 0.161 ms. with rotation takes 0.330 ms. 
</div>
</div><p>
<a class="anchor" name="7d5e997f3f896ee53fa48a683c50d1db"></a><!-- doxytag: member="cmat_extra.c::sq2cpy" ref="7d5e997f3f896ee53fa48a683c50d1db" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sq2cpy           </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
do a modules square and copy to real part of output 
<p>

</div>
</div><p>
<a class="anchor" name="f3bf0c08af81518daf8cf1b2c5a10439"></a><!-- doxytag: member="cmat_extra.c::realcpy" ref="f3bf0c08af81518daf8cf1b2c5a10439" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void realcpy           </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy the real part. 
<p>

</div>
</div><p>
<a class="anchor" name="e8f7121f498b7d4912301cf180680637"></a><!-- doxytag: member="cmat_extra.c::abscpy" ref="e8f7121f498b7d4912301cf180680637" args="(dcomplex *out, const dcomplex *in, const size_t length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void abscpy           </td>
          <td>(</td>
          <td class="paramtype">dcomplex *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy the absolute value to output. 
<p>

</div>
</div><p>
<a class="anchor" name="772387b5274cd5438d1612a1fd58d8d2"></a><!-- doxytag: member="cmat_extra.c::cembed" ref="772387b5274cd5438d1612a1fd58d8d2" args="(cmat *restrict A, const cmat *restrict B, const double theta, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembed           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Embed array B into A with rotation theta CW. 
<p>
Current version, preferred 
</div>
</div><p>
<a class="anchor" name="6f86acfdccdc2c5a1c3d02d4ae33ac15"></a><!-- doxytag: member="cmat_extra.c::cembedscaleout" ref="6f86acfdccdc2c5a1c3d02d4ae33ac15" args="(cmat *restrict A, const cmat *B, double xoutscale, double youtscale, const double theta, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cembedscaleout           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>xoutscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>youtscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
rotate (around fft center: (nx/2,ny/2)) CCW theta and embed in into A. 
<p>

</div>
</div><p>
<a class="anchor" name="b5a692d8dd9656bde4d9fe988d26695a"></a><!-- doxytag: member="cmat_extra.c::ccpcorner" ref="b5a692d8dd9656bde4d9fe988d26695a" args="(cmat *A, const cmat *restrict B, CEMBED flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccpcorner           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CEMBED&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
copy and embed/crop psfin into psfout 
<p>
<div class="fragment"><pre class="fragment">
   4 * * 3
   * * * *
   * * * *
   2 * * 1
   </pre></div> to <div class="fragment"><pre class="fragment">
   4 * * * 3
   * * * * *
   * * * * *
   * * * * *
   2 * * * 1 
   </pre></div> } 
</div>
</div><p>
<a class="anchor" name="23f317cbb6e5cad3b80acefd960f7c7f"></a><!-- doxytag: member="cmat_extra.c::cabs2toreal" ref="23f317cbb6e5cad3b80acefd960f7c7f" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabs2toreal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put abs square of each element into its realpart. 
<p>
A=abs(A).^2; 
</div>
</div><p>
<a class="anchor" name="952faac0b7598955f5d6108d66222707"></a><!-- doxytag: member="cmat_extra.c::cabstoreal" ref="952faac0b7598955f5d6108d66222707" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabstoreal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put abs of each elemnt into its realpart. 
<p>
A=abs(A); 
</div>
</div><p>
<a class="anchor" name="4ff6717c6a0f3919c71a2dc6fde5aae8"></a><!-- doxytag: member="cmat_extra.c::ccpd" ref="4ff6717c6a0f3919c71a2dc6fde5aae8" args="(cmat **restrict A0, const dmat *restrict B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ccpd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> **restrict&nbsp;</td>
          <td class="paramname"> <em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy a <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> into real part of <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="b2baa26f7bd8861ab342eee97889522d"></a><!-- doxytag: member="cmat_extra.c::creal2d" ref="b2baa26f7bd8861ab342eee97889522d" args="(dmat **restrict A0, double alpha, const cmat *restrict B, double beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void creal2d           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **restrict&nbsp;</td>
          <td class="paramname"> <em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy real part of a <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> to <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> with optional scaling: A0=A0. 
<p>
*alpha+real(B)*beta 
</div>
</div><p>
<a class="anchor" name="d50c3f29262e58d4032225e69edc892f"></a><!-- doxytag: member="cmat_extra.c::cabs22d" ref="d50c3f29262e58d4032225e69edc892f" args="(dmat **restrict A0, double alpha, const cmat *restrict B, double beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cabs22d           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **restrict&nbsp;</td>
          <td class="paramname"> <em>A0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *restrict&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy abs squared of a <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> to <a class="el" href="structdmat.html" title="a double matrix object contains 2-d array of double numbers">dmat</a> with optional scaling: A0=A0*alpha+abs(B). 
<p>
^2*beta; 
</div>
</div><p>
<a class="anchor" name="f912fcd3192a45180c528f075f1d0988"></a><!-- doxytag: member="cmat_extra.c::ctilt" ref="f912fcd3192a45180c528f075f1d0988" args="(cmat *otf, double sx, double sy, int pinct)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctilt           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>otf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pinct</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tilt the otf to make the image shift. 
<p>
apply exp(-2*pi*sx/nx)*exp(-2*pi*sy/ny) to otf to move the image sx, sy are shifts in terms of pixel. sx/nx is equivalent to sx*dtheta*du. pinct=1: peak is in center pinct=0: peak is in corner 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Nov 24 14:46:54 2010 for maos-0.7.5 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
