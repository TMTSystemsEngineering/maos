<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Multi-threaded Adaptive Optics Simulator: Simulation Parameters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multi-threaded Adaptive Optics Simulator
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page30.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Simulation Parameters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>All user modifiable options are configured through these config files with suffix <code></code>.conf.</p>
<p>The supplied default setup files are stored in sub-folder <code>config/maos</code>. The config files are organized in a modular way. One <code></code>.conf file can include another <code></code>.conf file with <code>include=”filename.conf”</code>. Most of the <code></code>.conf files in <code>config/maos</code> file are self-documented.</p>
<p>All the options are in the form of <code>key=value</code>. The usually convention is: if the entry in <code>parms</code> called <code>parms-&gt;wfs.thetax</code>, the entry in .conf file will be in the form <code>wfs.thetax=value</code>.</p>
<p>Some of the rules are:</p>
<ol type="1">
<li>Array values are preferred to be embraced by []</li>
<li>string are embraced by double or single quotes ('' or "").</li>
<li>A line ended with \ will be concatenated with the next line.</li>
<li>Anything after comment string # will be ignored during reading.</li>
</ol>
<p>The config <code>key=value</code> can be specified multiple times for any key, in which case the latter value will override the previous value. The software will complain and exit if any <code>key=value</code> pair is not understood or required but not provided.</p>
<p>The recommanded way to organize config files for a specific problem is to keep a baseline <code></code>.conf file in sub-folder <code>config/maos</code> in the source folder that specify all the necessary <code>key=value</code> entries through optionally including other <code></code>.conf files. The default entry is <code>default.conf</code> unless <code>-c file.conf</code> switch is supplied in the command line.</p>
<p>Embed the overriding options in the command line (embrace it with quote if the option contains spaces, like arrays) or put in one or multiple overriding file (in the simulation folder, not inside -c config/maos) to override the values you want to change from the baseline.</p>
<p>The <code></code>.conf files in the <code>config/maos</code> folder are only modified during code development and should not be modified by the end user. Use overriding <code></code>.conf files in simulation folders or embed configurations in the command line to modify the values.</p>
<p>In the <code>config/maos</code> sub-folder in the source folder, there are a few envelop <code></code>.conf files that is complete for each configuration:</p>
<ol type="1">
<li><code><code>nfiraos.conf</code></code> for NFIRAOS mcao simulations,</li>
<li><code><code>mcao_ngs.conf</code></code> for NGS mcao simulations</li>
<li><code><code>scao_lgs.conf</code></code> for single conjugate LGS simulation</li>
<li><code><code>scao_ngs.conf</code></code> for single conjugate NGS simulation.</li>
</ol>
<p>Each of this file include a few other <code></code>.conf files by specifying <code>include=<code>filename.conf</code></code>, for example, all these baseline <code></code>.conf files include the following common <code>.conf</code> files that is independent on the simulation mode or geometry.</p>
<ol type="1">
<li><code><code>sim.conf</code></code> to specify general simulation parameters such as loop gain, number of time steps, etc,</li>
<li><code><code>recon.conf</code></code> to specify reconstruction parameters in closed loop,</li>
<li><code><code>dbg.conf</code></code> to specify debugging parameters.</li>
</ol>
<p>The following list the exclusive <code>.conf</code> files used to specified particular set of configurations. Each group should only appear once.</p>
<ul>
<li><code>atm_*.conf</code>: set to a different preconfigured turbulence profile.</li>
</ul>
<ul>
<li><code>dm_*.conf</code>: set deformable mirror configuration.</li>
</ul>
<ul>
<li><code>fov_*.conf</code>: set the science FoV.</li>
</ul>
<ul>
<li><code>wfs_*.conf</code>: set the wfs type (excludes <code>wfs_common.conf</code>)</li>
</ul>
<p>For example, the baseline configuration for TMT MCAO system <code>nfiraos.conf</code> includes <code>atm_mk13n50p.conf</code> to specify MK13N median seeing turbulence profile, <code>dm_dual.conf</code> to specify dual DM system, <code>wfs_lgs_ttf_tt.conf</code> to specify WFS configuration as LGS WFS plus TTF NGS WFS plus TT NGS WFS, <code>fov_iris.conf</code> to specify the science FoV as simpson weighting on 3x3 points in the square FoV.</p>
<p>We can optionally setup one or more surfaces that can cover science fields or wavefront sensors. Put the list of surface <code>.bin</code> files in key <code>surf</code>. Each surface file must contain a 2-d array of the OPD with a header specifying the following keys:</p>
<pre class="fragment"> dx  the sampling in x direction (first dimension).
 dy  the sampling in y direction (second dimension).
 ox  the origin in x direction.
 oy  the origin in y direction.
 h   the height conjugation of this surface
 vx  the frozen flow wind speed along x of this surface (0 for static)
 vy  the frozen flow wind speed along y of this surface (0 for static)</pre><p>Use the write mex routine or writebin.m to write the bin file:</p>
<p>`write(OPD, header, 'file.bin')`</p>
<p>The amplitude map of the telescope can be specified with <code>aper.fnamp=aper.bin</code> with a similar data format, with OPD replaced by amplitude map between 0 and 1.</p>
<p>We can also setup one or more tilted M3 surfaces that are common to science fields and wavefront sensors. Put the list of surface files in key <code>tsurf</code>. Each surface file must contain a 2-d array with a header specifying the following keys:</p>
<pre class="fragment"> dx    the sampling in x direction (first dimension).
 dy    the sampling in y direction (second dimension).
 ox    the origin in x direction.
 oy    the origin in y direction.
 txdeg the x tilt angle in degrees wrt beam (90 is perp)
 tydeg the y tilt angle in degrees wrt beam (90 is perp)
 ftel  the telescope effective focal length
 fexit the distance between the exit pupil and the focus
 fsurf the distance between the center of the M3 surface and the focus.</pre><p><a class="el" href="nfiraos.html">Example: NFIRAOS</a> Shows the example configuration file for NFIRAOS.</p>
<p><a class="el" href="SCAO_NGS.html">Example: SCAO NGS</a> shows the example configuration file of a single conjugate NGS system.</p>
<p><a class="el" href="SCAO_LGS.html">Example: SCAO LGS</a> shows the example configuration file of a single conjugate LGS system. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
