<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>maos-1.0.1: skyc/setup_aster.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">maos-1.0.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('setup__aster_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>skyc/setup_aster.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>Routines to handle asterisms.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#ad3fa807794f44992a3e1a8b7dc0edd00">comb_select</a> (long n, long k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the number of possibilities of selection k items from n items <img class="formulaInl" alt="$C_n^k$" src="form_69.png"/>.  <a href="#ad3fa807794f44992a3e1a8b7dc0edd00"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a76b6d28cf50738ecd9851d4b11c61664">comb_init</a> (long k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize an initial combination composed a vector of non-negative numbers 0,1,2,...  <a href="#a76b6d28cf50738ecd9851d4b11c61664"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a0d8127a25ae2043c9c54d8d7f3115466">comb_next</a> (int *comb, long n, long k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the next combination.  <a href="#a0d8127a25ae2043c9c54d8d7f3115466"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a775e19b8c2c52a6258c7d943de3d4303">setup_aster_comb</a> (int *naster, int nstar, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create combination of stars to form asterism.  <a href="#a775e19b8c2c52a6258c7d943de3d4303"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a50dc7d12cb4690e99dab343b7cf7eec9">setup_aster_g</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structSTAR__S.html">STAR_S</a> *star, <a class="el" href="structPOWFS__S.html">POWFS_S</a> *powfs, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Modal to gradient operator by copying from the stars.  <a href="#a50dc7d12cb4690e99dab343b7cf7eec9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#ac5f2ea45439c6fe0dbb79f5fcbb51890">setup_aster_copystar</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structSTAR__S.html">STAR_S</a> *star, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy information from star struct <a class="el" href="structSTAR__S.html" title="Data for each available star.">STAR_S</a> to stars in asterism <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>.  <a href="#ac5f2ea45439c6fe0dbb79f5fcbb51890"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a0af703f2bfcb475b2480f5946ed8a44f">setup_aster_wvf</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structSTAR__S.html">STAR_S</a> *star, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy time history of complex pupil function from <a class="el" href="structSTAR__S.html" title="Data for each available star.">STAR_S</a> to <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>.  <a href="#a0af703f2bfcb475b2480f5946ed8a44f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a75bc43c46e3cc71b9f1492f3929183ff">calc_recon_error</a> (const <a class="el" href="structdmat.html">dmat</a> *pgm, const <a class="el" href="structdmat.html">dmat</a> *ineam, const <a class="el" href="structdmat.html">dmat</a> *mcc)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate wavefront error propagated from measurement error.  <a href="#a75bc43c46e3cc71b9f1492f3929183ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a15fffb6defdd36b2a2f7d3c00efaed62">setup_aster_recon</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structSTAR__S.html">STAR_S</a> *star, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the reconstructor for each <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>.  <a href="#a15fffb6defdd36b2a2f7d3c00efaed62"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a15479497479129e11877b757b0c80761">interp_gain</a> (double out[5], const <a class="el" href="structdcell.html">dcell</a> *gain, const <a class="el" href="structdmat.html">dmat</a> *gainx, double sigma2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate simu-&gt;gain.  <a href="#a15479497479129e11877b757b0c80761"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a8a20d80d33c6adceb86f8a76d1c76cf0">setup_aster_servo</a> (<a class="el" href="structSIM__S.html">SIM_S</a> *simu, <a class="el" href="structASTER__S.html">ASTER_S</a> *aster, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimize type II servo gains beased on measurement noise and signal PSD.  <a href="#a8a20d80d33c6adceb86f8a76d1c76cf0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a1c22bae6e81d5017ef7529fbf88e2ce5">sortfun</a> (const double *a, const double *b)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">for sort incrementally.  <a href="#a1c22bae6e81d5017ef7529fbf88e2ce5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a034bd25de2203b0d841829b8db05cdf6">setup_aster_select</a> (double *result, <a class="el" href="structASTER__S.html">ASTER_S</a> *aster, int naster, <a class="el" href="structSTAR__S.html">STAR_S</a> *star, double maxerror, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select a few asterisms that have decent performance (less than maxerror)  <a href="#a034bd25de2203b0d841829b8db05cdf6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#ade17b96ff13c31bdb279cf44b6dee974">setup_aster_regenpsf</a> (<a class="el" href="structdmat.html">dmat</a> *mideal, <a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structPOWFS__S.html">POWFS_S</a> *powfs, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Regenerate PSF By doing ztilt simulations and compute the average PSF with this ztilt resigual NGS modes.  <a href="#ade17b96ff13c31bdb279cf44b6dee974"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#a656fd368239d064d95b3f669baf1ee67">setup_aster_redomtch</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, <a class="el" href="structPOWFS__S.html">POWFS_S</a> *powfs, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute matched filter from PSFs.  <a href="#a656fd368239d064d95b3f669baf1ee67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup__aster_8c.html#ab4edbba502e193755bec6e1ea6687ad0">free_aster</a> (<a class="el" href="structASTER__S.html">ASTER_S</a> *aster, int naster, const <a class="el" href="structPARMS__S.html">PARMS_S</a> *parms)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a> array.  <a href="#ab4edbba502e193755bec6e1ea6687ad0"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Routines to handle asterisms. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad3fa807794f44992a3e1a8b7dc0edd00"></a><!-- doxytag: member="setup_aster.c::comb_select" ref="ad3fa807794f44992a3e1a8b7dc0edd00" args="(long n, long k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static long comb_select </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Computes the number of possibilities of selection k items from n items <img class="formulaInl" alt="$C_n^k$" src="form_69.png"/>. </p>

</div>
</div>
<a class="anchor" id="a76b6d28cf50738ecd9851d4b11c61664"></a><!-- doxytag: member="setup_aster.c::comb_init" ref="a76b6d28cf50738ecd9851d4b11c61664" args="(long k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int* comb_init </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>k</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initialize an initial combination composed a vector of non-negative numbers 0,1,2,... </p>

</div>
</div>
<a class="anchor" id="a0d8127a25ae2043c9c54d8d7f3115466"></a><!-- doxytag: member="setup_aster.c::comb_next" ref="a0d8127a25ae2043c9c54d8d7f3115466" args="(int *comb, long n, long k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int comb_next </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>comb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find the next combination. </p>

</div>
</div>
<a class="anchor" id="a775e19b8c2c52a6258c7d943de3d4303"></a><!-- doxytag: member="setup_aster.c::setup_aster_comb" ref="a775e19b8c2c52a6258c7d943de3d4303" args="(int *naster, int nstar, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structASTER__S.html">ASTER_S</a>* setup_aster_comb </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>naster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create combination of stars to form asterism. </p>
<p>It has the option to put TTF always on the brightest for testing purpose. </p>

</div>
</div>
<a class="anchor" id="a50dc7d12cb4690e99dab343b7cf7eec9"></a><!-- doxytag: member="setup_aster.c::setup_aster_g" ref="a50dc7d12cb4690e99dab343b7cf7eec9" args="(ASTER_S *aster, STAR_S *star, POWFS_S *powfs, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_g </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSTAR__S.html">STAR_S</a> *&#160;</td>
          <td class="paramname"><em>star</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPOWFS__S.html">POWFS_S</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute Modal to gradient operator by copying from the stars. </p>
<p>Using average gradients. Similar to Z tilt since the mode is low order </p>

</div>
</div>
<a class="anchor" id="ac5f2ea45439c6fe0dbb79f5fcbb51890"></a><!-- doxytag: member="setup_aster.c::setup_aster_copystar" ref="ac5f2ea45439c6fe0dbb79f5fcbb51890" args="(ASTER_S *aster, STAR_S *star, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_copystar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSTAR__S.html">STAR_S</a> *&#160;</td>
          <td class="paramname"><em>star</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy information from star struct <a class="el" href="structSTAR__S.html" title="Data for each available star.">STAR_S</a> to stars in asterism <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>. </p>

</div>
</div>
<a class="anchor" id="a0af703f2bfcb475b2480f5946ed8a44f"></a><!-- doxytag: member="setup_aster.c::setup_aster_wvf" ref="a0af703f2bfcb475b2480f5946ed8a44f" args="(ASTER_S *aster, STAR_S *star, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_wvf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSTAR__S.html">STAR_S</a> *&#160;</td>
          <td class="paramname"><em>star</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy time history of complex pupil function from <a class="el" href="structSTAR__S.html" title="Data for each available star.">STAR_S</a> to <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>. </p>

</div>
</div>
<a class="anchor" id="a75bc43c46e3cc71b9f1492f3929183ff"></a><!-- doxytag: member="setup_aster.c::calc_recon_error" ref="a75bc43c46e3cc71b9f1492f3929183ff" args="(const dmat *pgm, const dmat *ineam, const dmat *mcc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structdmat.html">dmat</a>* calc_recon_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>pgm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>ineam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>mcc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Estimate wavefront error propagated from measurement error. </p>
<p>pgm is the reconstructor. ineam is the error inverse. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pgm</td><td>the reconstructor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ineam</td><td>the inverse of error covariance matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mcc</td><td>NGS mode covariance matrix. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a15fffb6defdd36b2a2f7d3c00efaed62"></a><!-- doxytag: member="setup_aster.c::setup_aster_recon" ref="a15fffb6defdd36b2a2f7d3c00efaed62" args="(ASTER_S *aster, STAR_S *star, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_recon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSTAR__S.html">STAR_S</a> *&#160;</td>
          <td class="paramname"><em>star</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Setup the reconstructor for each <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a>. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[R_{ngs}=(G_M^T C_n^{-1} G_M)^{-1})G_M^T C_n^{-1}\]" src="form_70.png"/>
</p>
<ul>
<li><img class="formulaInl" alt="$R_{ngs}$" src="form_71.png"/> is the reconstructor.</li>
</ul>
<ul>
<li><img class="formulaInl" alt="$C_n^{-1}$" src="form_72.png"/> is the measurement error covariance matrix. Inclue both the measurement error and tilt anisoplanatism effects (computed as the variance of noise free gradient on PSFs that have ideal NGS compensation</li>
</ul>
<ul>
<li><img class="formulaInl" alt="$G_M^T$" src="form_73.png"/> is the NGS mode to gradient operator. </li>
</ul>

</div>
</div>
<a class="anchor" id="a15479497479129e11877b757b0c80761"></a><!-- doxytag: member="setup_aster.c::interp_gain" ref="a15479497479129e11877b757b0c80761" args="(double out[5], const dcell *gain, const dmat *gainx, double sigma2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void interp_gain </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>out</em>[5], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&#160;</td>
          <td class="paramname"><em>gain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>gainx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Interpolate simu-&gt;gain. </p>

</div>
</div>
<a class="anchor" id="a8a20d80d33c6adceb86f8a76d1c76cf0"></a><!-- doxytag: member="setup_aster.c::setup_aster_servo" ref="a8a20d80d33c6adceb86f8a76d1c76cf0" args="(SIM_S *simu, ASTER_S *aster, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_servo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSIM__S.html">SIM_S</a> *&#160;</td>
          <td class="paramname"><em>simu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Optimize type II servo gains beased on measurement noise and signal PSD. </p>
<p>We try to minimize </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^2=\int \textrm{PSD}_{ngs,ws}H_{rej}\textrm{d}\nu + \int_0^{\nu_{nyquist}} \textrm{PSF}\textrm{d}\nu \]" src="form_74.png"/>
</p>
 
</div>
</div>
<a class="anchor" id="a1c22bae6e81d5017ef7529fbf88e2ce5"></a><!-- doxytag: member="setup_aster.c::sortfun" ref="a1c22bae6e81d5017ef7529fbf88e2ce5" args="(const double *a, const double *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int sortfun </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>for sort incrementally. </p>

</div>
</div>
<a class="anchor" id="a034bd25de2203b0d841829b8db05cdf6"></a><!-- doxytag: member="setup_aster.c::setup_aster_select" ref="a034bd25de2203b0d841829b8db05cdf6" args="(double *result, ASTER_S *aster, int naster, STAR_S *star, double maxerror, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_select </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>naster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSTAR__S.html">STAR_S</a> *&#160;</td>
          <td class="paramname"><em>star</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxerror</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Select a few asterisms that have decent performance (less than maxerror) </p>

</div>
</div>
<a class="anchor" id="ade17b96ff13c31bdb279cf44b6dee974"></a><!-- doxytag: member="setup_aster.c::setup_aster_regenpsf" ref="ade17b96ff13c31bdb279cf44b6dee974" args="(dmat *mideal, ASTER_S *aster, POWFS_S *powfs, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_regenpsf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>mideal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPOWFS__S.html">POWFS_S</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Regenerate PSF By doing ztilt simulations and compute the average PSF with this ztilt resigual NGS modes. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>record pistat during physical optics simulation and rerun them might help further! </dd></dl>

</div>
</div>
<a class="anchor" id="a656fd368239d064d95b3f669baf1ee67"></a><!-- doxytag: member="setup_aster.c::setup_aster_redomtch" ref="a656fd368239d064d95b3f669baf1ee67" args="(ASTER_S *aster, POWFS_S *powfs, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_aster_redomtch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPOWFS__S.html">POWFS_S</a> *&#160;</td>
          <td class="paramname"><em>powfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute matched filter from PSFs. </p>

</div>
</div>
<a class="anchor" id="ab4edbba502e193755bec6e1ea6687ad0"></a><!-- doxytag: member="setup_aster.c::free_aster" ref="ab4edbba502e193755bec6e1ea6687ad0" args="(ASTER_S *aster, int naster, const PARMS_S *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_aster </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structASTER__S.html">ASTER_S</a> *&#160;</td>
          <td class="paramname"><em>aster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>naster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__S.html">PARMS_S</a> *&#160;</td>
          <td class="paramname"><em>parms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free the <a class="el" href="structASTER__S.html" title="asterism dependent data.">ASTER_S</a> array. </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="setup__aster_8c.html">setup_aster.c</a>      </li>
      <li class="footer">Generated on Thu Jan 19 2012 17:43:39 for maos-1.0.1 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>

</body>
</html>
