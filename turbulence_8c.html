<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>maos-1.2.0: lib/turbulence.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="/home/lianqiw/work/programming/aos/doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">maos-1.2.0
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('turbulence_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lib/turbulence.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains routines to generate atmospheric turbulence screens.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <b>T_VONKARMAN</b>, 
<b>T_FRACTAL</b>, 
<b>T_BIHARMONIC</b>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a6103423bb3c5cc8b865aa239148f809a">get_fnatm</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">hash the data to get a unique file name  <a href="#a6103423bb3c5cc8b865aa239148f809a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#affc264c1829e32f8ff8aefaa8aeb5a1f">spect_screen_save</a> (<a class="el" href="structcellarr.html">cellarr</a> *fc, <a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Geneate the screens sequentially and appends to file if fc is not NULL.  <a href="#affc264c1829e32f8ff8aefaa8aeb5a1f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a7a0408958e97be83faa398d0846cb37a">spect_screen_do</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate turbulence screens all in memory.  <a href="#a7a0408958e97be83faa398d0846cb37a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structmap__t.html">map_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a2bcb48d15c4763925ec931028ccf6174">create_screen</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data, void(*funsave)(<a class="el" href="structcellarr.html">cellarr</a> *fc, <a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data), void(*funmem)(<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates multiple screens from spectrum.  <a href="#a2bcb48d15c4763925ec931028ccf6174"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmap__t.html">map_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a58cb269cc05ae0ce8ac42bc0825285dd">vonkarman_screen</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate vonkarman screens from turbulence statistics.  <a href="#a58cb269cc05ae0ce8ac42bc0825285dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmap__t.html">map_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#abde6486d95cbe48bc7aef19d6313ab20">biharmonic_screen</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate screens from PSD with power of 12/3 instead of 11/3.  <a href="#abde6486d95cbe48bc7aef19d6313ab20"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a5381df5cd59e92000940b0ba7f7c19d8">fractal_screen_save</a> (<a class="el" href="structcellarr.html">cellarr</a> *fc, <a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate one screen at a time and save to file.  <a href="#a5381df5cd59e92000940b0ba7f7c19d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5adcbb0f783e55874fd6b2f65f6de94e"></a><!-- doxytag: member="turbulence.c::fractal_screen_thread" ref="a5adcbb0f783e55874fd6b2f65f6de94e" args="(GENSCREEN_T *data)" -->
static void&#160;</td><td class="memItemRight" valign="bottom"><b>fractal_screen_thread</b> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ec9b6c5a4b052759948cf98ec2aded1"></a><!-- doxytag: member="turbulence.c::fractal_screen_do" ref="a1ec9b6c5a4b052759948cf98ec2aded1" args="(GENSCREEN_T *data)" -->
static void&#160;</td><td class="memItemRight" valign="bottom"><b>fractal_screen_do</b> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmap__t.html">map_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#aa035016a167fef5bf8ca97fb9ec931bb">fractal_screen</a> (<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate Fractal screens.  <a href="#aa035016a167fef5bf8ca97fb9ec931bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a8a0813e128c3d37863bbd6c34bad5196">turbcov</a> (<a class="el" href="structdmat.html">dmat</a> *r, double rmax, double r0, double L0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the covariance for separation of r, and put the values in cov.  <a href="#a8a0813e128c3d37863bbd6c34bad5196"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdmat.html">dmat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="turbulence_8c.html#a37c204f03307e1c84d10e3ee0baf1c7f">turbpsd_full</a> (long nx, long ny, double dx, double r0, double L0, double slope, double power)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the turbulence spectrum at size nx*ny, with spacing dx.  <a href="#a37c204f03307e1c84d10e3ee0baf1c7f"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Contains routines to generate atmospheric turbulence screens. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6103423bb3c5cc8b865aa239148f809a"></a><!-- doxytag: member="turbulence.c::get_fnatm" ref="a6103423bb3c5cc8b865aa239148f809a" args="(GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* <a class="el" href="turbulence_8c.html#a6103423bb3c5cc8b865aa239148f809a">get_fnatm</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>hash the data to get a unique file name </p>

</div>
</div>
<a class="anchor" id="affc264c1829e32f8ff8aefaa8aeb5a1f"></a><!-- doxytag: member="turbulence.c::spect_screen_save" ref="affc264c1829e32f8ff8aefaa8aeb5a1f" args="(cellarr *fc, GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="turbulence_8c.html#affc264c1829e32f8ff8aefaa8aeb5a1f">spect_screen_save</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcellarr.html">cellarr</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Geneate the screens sequentially and appends to file if fc is not NULL. </p>
<p>Handles large screens well without using the full storage. </p>

</div>
</div>
<a class="anchor" id="a7a0408958e97be83faa398d0846cb37a"></a><!-- doxytag: member="turbulence.c::spect_screen_do" ref="a7a0408958e97be83faa398d0846cb37a" args="(GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="turbulence_8c.html#a7a0408958e97be83faa398d0846cb37a">spect_screen_do</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate turbulence screens all in memory. </p>

</div>
</div>
<a class="anchor" id="a2bcb48d15c4763925ec931028ccf6174"></a><!-- doxytag: member="turbulence.c::create_screen" ref="a2bcb48d15c4763925ec931028ccf6174" args="(GENSCREEN_T *data, void(*funsave)(cellarr *fc, GENSCREEN_T *data), void(*funmem)(GENSCREEN_T *data))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structmap__t.html">map_t</a>** <a class="el" href="turbulence_8c.html#a2bcb48d15c4763925ec931028ccf6174">create_screen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="structcellarr.html">cellarr</a> *fc, <a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)&#160;</td>
          <td class="paramname"><em>funsave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *data)&#160;</td>
          <td class="paramname"><em>funmem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates multiple screens from spectrum. </p>
<p>Note that if data-&gt;share=1, the atmosphere will be different from data-&gt;share=0 due to different algorithms used. </p>

</div>
</div>
<a class="anchor" id="a58cb269cc05ae0ce8ac42bc0825285dd"></a><!-- doxytag: member="turbulence.c::vonkarman_screen" ref="a58cb269cc05ae0ce8ac42bc0825285dd" args="(GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmap__t.html">map_t</a>** <a class="el" href="turbulence_8c.html#a58cb269cc05ae0ce8ac42bc0825285dd">vonkarman_screen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate vonkarman screens from turbulence statistics. </p>

</div>
</div>
<a class="anchor" id="abde6486d95cbe48bc7aef19d6313ab20"></a><!-- doxytag: member="turbulence.c::biharmonic_screen" ref="abde6486d95cbe48bc7aef19d6313ab20" args="(GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmap__t.html">map_t</a>** <a class="el" href="turbulence_8c.html#abde6486d95cbe48bc7aef19d6313ab20">biharmonic_screen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate screens from PSD with power of 12/3 instead of 11/3. </p>

</div>
</div>
<a class="anchor" id="a5381df5cd59e92000940b0ba7f7c19d8"></a><!-- doxytag: member="turbulence.c::fractal_screen_save" ref="a5381df5cd59e92000940b0ba7f7c19d8" args="(cellarr *fc, GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="turbulence_8c.html#a5381df5cd59e92000940b0ba7f7c19d8">fractal_screen_save</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcellarr.html">cellarr</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate one screen at a time and save to file. </p>

</div>
</div>
<a class="anchor" id="aa035016a167fef5bf8ca97fb9ec931bb"></a><!-- doxytag: member="turbulence.c::fractal_screen" ref="aa035016a167fef5bf8ca97fb9ec931bb" args="(GENSCREEN_T *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmap__t.html">map_t</a>** <a class="el" href="turbulence_8c.html#aa035016a167fef5bf8ca97fb9ec931bb">fractal_screen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGENSCREEN__T.html">GENSCREEN_T</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate Fractal screens. </p>
<p>Not good statistics. </p>

</div>
</div>
<a class="anchor" id="a8a0813e128c3d37863bbd6c34bad5196"></a><!-- doxytag: member="turbulence.c::turbcov" ref="a8a0813e128c3d37863bbd6c34bad5196" args="(dmat *r, double rmax, double r0, double L0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdmat.html">dmat</a>* <a class="el" href="turbulence_8c.html#a8a0813e128c3d37863bbd6c34bad5196">turbcov</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the covariance for separation of r, and put the values in cov. </p>
<p>In kolmogorov spectrum, the variance are defined as half of the structure function between two points separated by rmax. </p>

</div>
</div>
<a class="anchor" id="a37c204f03307e1c84d10e3ee0baf1c7f"></a><!-- doxytag: member="turbulence.c::turbpsd_full" ref="a37c204f03307e1c84d10e3ee0baf1c7f" args="(long nx, long ny, double dx, double r0, double L0, double slope, double power)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdmat.html">dmat</a>* <a class="el" href="turbulence_8c.html#a37c204f03307e1c84d10e3ee0baf1c7f">turbpsd_full</a> </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the turbulence spectrum at size nx*ny, with spacing dx. </p>
<p>Notice that the zero frequency component is in the corner psd-&gt;p[0]. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nx</td><td>The size </td></tr>
    <tr><td class="paramname">ny</td><td>The size </td></tr>
    <tr><td class="paramname">dx</td><td>The sampling of spatial coordinate. </td></tr>
    <tr><td class="paramname">r0</td><td>The Fried parameter </td></tr>
    <tr><td class="paramname">L0</td><td>The outer scale </td></tr>
    <tr><td class="paramname">slope</td><td>should be -11/6 for von karman or kolmogorov screens, or -2 for biharmonic screen (just testing only). </td></tr>
    <tr><td class="paramname">power</td><td>optionally do a power of psd. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="turbulence_8c.html">turbulence.c</a>      </li>

    <li class="footer">Generated on Tue Aug 14 2012 09:57:34 for maos-1.2.0 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
