<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>maos-0.6.4: lib/draw.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/draw.c File Reference</h1>Contains functions for data visualization.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ffede8158729b814e7ef2eb56636b976"></a><!-- doxytag: member="draw.c::DOPPRINT" ref="ffede8158729b814e7ef2eb56636b976" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>DOPPRINT</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2b85814519edc18cb2dd584d0cb09b92"></a><!-- doxytag: member="draw.c::FWRITE" ref="2b85814519edc18cb2dd584d0cb09b92" args="(ptr, size, nmemb, fp)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FWRITE</b>(ptr, size, nmemb, fp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8421c8428f6785630818d15241888098"></a><!-- doxytag: member="draw.c::FWRITEINT" ref="8421c8428f6785630818d15241888098" args="(fp, cmd)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FWRITEINT</b>(fp, cmd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="16a4b6cf7310104a95a8950b9f805314"></a><!-- doxytag: member="draw.c::FWRITESTR" ref="16a4b6cf7310104a95a8950b9f805314" args="(fp, arg)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FWRITESTR</b>(fp, arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="42c77bf94fd656aa8344c3aa54e340b5"></a><!-- doxytag: member="draw.c::FWRITECMDSTR" ref="42c77bf94fd656aa8344c3aa54e340b5" args="(fp, cmd, arg)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FWRITECMDSTR</b>(fp, cmd, arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dbd366af90e179e780c2c94db5fb0cdc"></a><!-- doxytag: member="draw.c::FIFO_ERROR" ref="dbd366af90e179e780c2c94db5fb0cdc" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FIFO_ERROR</b></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d37f2bafef682ff02c05df8cfab4913c"></a><!-- doxytag: member="draw.c::fifo_open" ref="d37f2bafef682ff02c05df8cfab4913c" args="(const char *fifo)" -->
static FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><b>fifo_open</b> (const char *fifo)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a522cbeee49506ae67fe994304ad476a"></a><!-- doxytag: member="draw.c::fifo_write" ref="a522cbeee49506ae67fe994304ad476a" args="(const void *ptr, size_t size, size_t nmemb, FILE *fp)" -->
static int&nbsp;</td><td class="memItemRight" valign="bottom"><b>fifo_write</b> (const void *ptr, size_t size, size_t nmemb, FILE *fp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#3d11dad9ce3744359ec458551c53f393">plot_coord</a> (char *fig, long npts, const double *ptsx, const double *ptsy, const long *style, const double *limit, int ncir, const void *pcir, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plot the coordinates ptsx, ptsy using style, and optionally plot ncir circles.  <a href="#3d11dad9ce3744359ec458551c53f393"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a833e764d7dcea34d83665cbb6b9e48d"></a><!-- doxytag: member="draw.c::imagesc_do" ref="a833e764d7dcea34d83665cbb6b9e48d" args="(char *fig, long nx, long ny, const double *limit, const void *p, int type, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><b>imagesc_do</b> (char *fig, long nx, long ny, const double *limit, const void *p, int type, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f">imagesc</a> (char *fig, long nx, long ny, const double *limit, const double *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Draw the OPD of double p defined on nx*ny grid.  <a href="#9cb7ab0234de01be82e2386ea09d342f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#dab8a67914c771232ac03a525fa9877f">imagesc_long</a> (char *fig, long nx, long ny, const double *limit, const long *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Draw the OPD of long p defined on nx*ny grid.  <a href="#dab8a67914c771232ac03a525fa9877f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#5bcab75037640d1cb5941078f857dae7">imagesc_cmp</a> (char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Draw the OPD of abs of complex p defined on nx*ny grid.  <a href="#5bcab75037640d1cb5941078f857dae7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#6d3db72deaecd3bf018163252986c633">imagesc_cmp_ri</a> (char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Draw the OPD of real and imaginary of complex p defined on nx*ny grid.  <a href="#6d3db72deaecd3bf018163252986c633"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#2e0f8dbda688cfa30e822aa38a35a240">imagesc_cmp_ap</a> (char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Draw the OPD of abs and phase of complex p defined on nx*ny grid.  <a href="#2e0f8dbda688cfa30e822aa38a35a240"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#8a0546beadad0f5031ad5e2160be53a9">ddraw</a> (char *fig, const <a class="el" href="structdmat.html">dmat</a> *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping the floating point numbers onto screen with scaling similar to matlab imagesc.  <a href="#8a0546beadad0f5031ad5e2160be53a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#d6a00fdf1415088dc897f3065b4f9c2d">cdrawabs</a> (char *fig, const <a class="el" href="structcmat.html">cmat</a> *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping the absolution value of complex array.  <a href="#d6a00fdf1415088dc897f3065b4f9c2d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#07222a8a78a714cf79af93eba4c69cdc">cdrawri</a> (char *fig, const <a class="el" href="structcmat.html">cmat</a> *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping the real/imaginary part of complex array.  <a href="#07222a8a78a714cf79af93eba4c69cdc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#c1cda6738a5ee34ed11eee39829cf690">cdraw</a> (char *fig, const <a class="el" href="structcmat.html">cmat</a> *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping the absolute and phase of complex array.  <a href="#c1cda6738a5ee34ed11eee39829cf690"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#cd04347e8f08fcef0e42ee57056d32ed">drawmap</a> (char *fig, const <a class="el" href="structMAP__T.html">MAP_T</a> *map, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">like ddraw, acting on sqmap object.  <a href="#cd04347e8f08fcef0e42ee57056d32ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#afc781f35ce1954a3041bf4d30e19384">drawloc</a> (char *fig, <a class="el" href="structLOC__T.html">LOC_T</a> *loc, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plot the loc on the screen.  <a href="#afc781f35ce1954a3041bf4d30e19384"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#ea2a96b41c5f08d3929a3f451e46feb3">drawopd</a> (char *fig, <a class="el" href="structLOC__T.html">LOC_T</a> *loc, const double *opd, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plot the opd using coordinate loc.  <a href="#ea2a96b41c5f08d3929a3f451e46feb3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#0aaab8cf8f5f9fa84865586e1f70722b">drawopdamp</a> (char *fig, <a class="el" href="structLOC__T.html">LOC_T</a> *loc, const double *opd, const double *amp, const char *title, const char *xlabel, const char *ylabel, const char *format,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plot opd*amp with coordinate loc.  <a href="#0aaab8cf8f5f9fa84865586e1f70722b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#64bf220e2fe22080f5976cb7b451cc8e">bin</a> (long nx, long ny, double *restrict p, int factor)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bin a double matrix from nx*ny to (nx/factor)*(ny*factor)  <a href="#64bf220e2fe22080f5976cb7b451cc8e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#19282078024715081530a34a20ae7f02">crp</a> (double x, double x0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert double to int  <a href="#19282078024715081530a34a20ae7f02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#946198fe3c1a7c7c5a91982808f90926">dbl2gray</a> (long nx, long ny, const double *restrict p, unsigned char *pc, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert double to char with color map  <a href="#946198fe3c1a7c7c5a91982808f90926"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#130b2012a152d0a74d99fb163e0a44eb">long2gray</a> (long nx, long ny, const long *restrict p, unsigned char *pc, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert long to char with color map  <a href="#130b2012a152d0a74d99fb163e0a44eb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#bdf3def1b58a1af325454ac890988543">cmp2gray</a> (long nx, long ny, const dcomplex *restrict p, unsigned char *pc, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert complex to char with color map  <a href="#bdf3def1b58a1af325454ac890988543"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#6aca171c6c895b50927f847817d42985">dbl2rgb</a> (long nx, long ny, const double *restrict p, int *pi, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert double to char with color map  <a href="#6aca171c6c895b50927f847817d42985"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#0f0efdf70b82ba86cacb8c873983f3a4">long2rgb</a> (long nx, long ny, const long *restrict p, int *restrict pi, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert long to char with color map  <a href="#0f0efdf70b82ba86cacb8c873983f3a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="draw_8c.html#b09bfb86fa6467aca41b4a0fd5d7a698">cmp2rgb</a> (long nx, long ny, const dcomplex *restrict p, int *pi, double *info)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert complex to char with color map  <a href="#b09bfb86fa6467aca41b4a0fd5d7a698"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Contains functions for data visualization. 
<p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="3d11dad9ce3744359ec458551c53f393"></a><!-- doxytag: member="draw.c::plot_coord" ref="3d11dad9ce3744359ec458551c53f393" args="(char *fig, long npts, const double *ptsx, const double *ptsy, const long *style, const double *limit, int ncir, const void *pcir, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plot_coord           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>ptsx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>ptsy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&nbsp;</td>
          <td class="paramname"> <em>style</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>pcir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Plot the coordinates ptsx, ptsy using style, and optionally plot ncir circles. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00123"></a>00123                                  {
<a name="l00124"></a>00124     FILE *fp=NULL;
<a name="l00125"></a>00125     <span class="keywordflow">if</span>(disable_draw) <span class="keywordflow">return</span>;
<a name="l00126"></a>00126     format2fn;
<a name="l00127"></a>00127     LOCK(lock);
<a name="l00128"></a>00128     fifo_save=scheduler_get_drawdaemon(getpid());
<a name="l00129"></a>00129     <span class="keywordflow">if</span>(!fifo_save){
<a name="l00130"></a>00130     disable_draw=1;
<a name="l00131"></a>00131     warning(<span class="stringliteral">"Unable to draw. check whether drawdaemon is "</span>
<a name="l00132"></a>00132         <span class="stringliteral">"in current directory\n"</span>);
<a name="l00133"></a>00133     <span class="keywordflow">goto</span> done;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135     fp=fifo_open(fifo_save);
<a name="l00136"></a>00136     <span class="keywordflow">if</span>(!fp){
<a name="l00137"></a>00137     <span class="keywordflow">goto</span> done;
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139     <span class="comment">//info2("pts");getchar();</span>
<a name="l00140"></a>00140     FWRITEINT(fp, FIFO_START);
<a name="l00141"></a>00141     <span class="keywordflow">if</span>(npts&gt;0){
<a name="l00142"></a>00142     FWRITEINT(fp, FIFO_POINTS);
<a name="l00143"></a>00143     FWRITEINT(fp, npts);
<a name="l00144"></a>00144     FWRITE(ptsx, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), npts, fp);
<a name="l00145"></a>00145     FWRITE(ptsy, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), npts, fp);
<a name="l00146"></a>00146     <span class="keywordflow">if</span>(style){
<a name="l00147"></a>00147         FWRITEINT(fp,FIFO_STYLE);
<a name="l00148"></a>00148         FWRITEINT(fp,npts);
<a name="l00149"></a>00149         FWRITE(style,<span class="keyword">sizeof</span>(<span class="keywordtype">long</span>),npts,fp);
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152     <span class="keywordflow">if</span>(ncir&gt;0){
<a name="l00153"></a>00153     FWRITEINT(fp, FIFO_CIRCLE);
<a name="l00154"></a>00154     FWRITEINT(fp, ncir);
<a name="l00155"></a>00155     FWRITE(pcir, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), ncir*4, fp);
<a name="l00156"></a>00156     }
<a name="l00157"></a>00157     <span class="keywordflow">if</span>(limit){<span class="comment">//xmin,xmax,ymin,ymax</span>
<a name="l00158"></a>00158     FWRITEINT(fp, FIFO_LIMIT);
<a name="l00159"></a>00159     FWRITE(limit, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), 4, fp);
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161     <span class="keywordflow">if</span>(format){
<a name="l00162"></a>00162     FWRITECMDSTR(fp,FIFO_NAME,fn);
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     FWRITECMDSTR(fp,FIFO_FIG,fig);
<a name="l00165"></a>00165     FWRITECMDSTR(fp,FIFO_TITLE,title);
<a name="l00166"></a>00166     FWRITECMDSTR(fp,FIFO_XLABEL,xlabel);
<a name="l00167"></a>00167     FWRITECMDSTR(fp,FIFO_YLABEL,ylabel);
<a name="l00168"></a>00168     FWRITEINT(fp,FIFO_END);
<a name="l00169"></a>00169  done:
<a name="l00170"></a>00170     <span class="keywordflow">if</span>(fp) fclose(fp);
<a name="l00171"></a>00171     UNLOCK(lock); 
<a name="l00172"></a>00172 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9cb7ab0234de01be82e2386ea09d342f"></a><!-- doxytag: member="draw.c::imagesc" ref="9cb7ab0234de01be82e2386ea09d342f" args="(char *fig, long nx, long ny, const double *limit, const double *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imagesc           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Draw the OPD of double p defined on nx*ny grid. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00242"></a>00242                                 {
<a name="l00243"></a>00243     format2fn;
<a name="l00244"></a>00244     imagesc_do(fig, nx, ny, limit, p, T_DOUBLE, color, title, xlabel, ylabel, <span class="stringliteral">"%s"</span>,fn);
<a name="l00245"></a>00245 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dab8a67914c771232ac03a525fa9877f"></a><!-- doxytag: member="draw.c::imagesc_long" ref="dab8a67914c771232ac03a525fa9877f" args="(char *fig, long nx, long ny, const double *limit, const long *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imagesc_long           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Draw the OPD of long p defined on nx*ny grid. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00252"></a>00252                                  {
<a name="l00253"></a>00253     format2fn;
<a name="l00254"></a>00254     imagesc_do(fig, nx, ny, limit, p, T_LONG, color, title, xlabel, ylabel, <span class="stringliteral">"%s"</span>,fn);
<a name="l00255"></a>00255 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5bcab75037640d1cb5941078f857dae7"></a><!-- doxytag: member="draw.c::imagesc_cmp" ref="5bcab75037640d1cb5941078f857dae7" args="(char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imagesc_cmp           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Draw the OPD of abs of complex p defined on nx*ny grid. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00262"></a>00262                                 {
<a name="l00263"></a>00263     format2fn;
<a name="l00264"></a>00264     imagesc_do(fig, nx, ny, limit, p, T_DCOMPLEX, color,
<a name="l00265"></a>00265            title, xlabel, ylabel, <span class="stringliteral">"%s abs"</span>, fn);
<a name="l00266"></a>00266 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6d3db72deaecd3bf018163252986c633"></a><!-- doxytag: member="draw.c::imagesc_cmp_ri" ref="6d3db72deaecd3bf018163252986c633" args="(char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imagesc_cmp_ri           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Draw the OPD of real and imaginary of complex p defined on nx*ny grid. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00273"></a>00273                                    {
<a name="l00274"></a>00274     <span class="keywordflow">if</span>(disable_draw) <span class="keywordflow">return</span>;
<a name="l00275"></a>00275     format2fn;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     <span class="keywordtype">double</span> *pr,*pi;
<a name="l00278"></a>00278     pr=malloc(nx*ny*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00279"></a>00279     pi=malloc(nx*ny*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00280"></a>00280     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00281"></a>00281     pr[i]=creal(p[i]);
<a name="l00282"></a>00282     pi[i]=cimag(p[i]);
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284     imagesc_do(fig, nx, ny, limit, pr, T_DOUBLE, color,title, xlabel, ylabel,
<a name="l00285"></a>00285            <span class="stringliteral">"%s real"</span>,fn);
<a name="l00286"></a>00286     free(pr);
<a name="l00287"></a>00287     imagesc_do(fig, nx, ny, limit, pi, T_DOUBLE, color,title, xlabel, ylabel,
<a name="l00288"></a>00288            <span class="stringliteral">"%s imag"</span>,fn);
<a name="l00289"></a>00289     free(pi);
<a name="l00290"></a>00290 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2e0f8dbda688cfa30e822aa38a35a240"></a><!-- doxytag: member="draw.c::imagesc_cmp_ap" ref="2e0f8dbda688cfa30e822aa38a35a240" args="(char *fig, long nx, long ny, const double *limit, const dcomplex *p, int color, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imagesc_cmp_ap           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Draw the OPD of abs and phase of complex p defined on nx*ny grid. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00297"></a>00297                                    {
<a name="l00298"></a>00298     <span class="keywordflow">if</span>(disable_draw) <span class="keywordflow">return</span>;
<a name="l00299"></a>00299     format2fn;
<a name="l00300"></a>00300     <span class="keywordtype">double</span> *pr,*pi;
<a name="l00301"></a>00301     <span class="keywordtype">int</span> isreal=1;
<a name="l00302"></a>00302     pr=malloc(nx*ny*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00303"></a>00303     pi=calloc(nx*ny,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00304"></a>00304     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00305"></a>00305     pr[i]=cabs(p[i]);
<a name="l00306"></a>00306     <span class="keywordflow">if</span>(pr[i]&gt;1.e-10){
<a name="l00307"></a>00307         pi[i]=atan2(cimag(p[i]),creal(p[i]));
<a name="l00308"></a>00308         <span class="keywordflow">if</span>(isreal&amp;&amp;fabs(pi[i])&gt;1.e-10) isreal=0;
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311     imagesc_do(fig, nx, ny, limit,  pr, T_DOUBLE, color, title, xlabel, ylabel,
<a name="l00312"></a>00312            <span class="stringliteral">"%s abs"</span>,fn);
<a name="l00313"></a>00313     free(pr);
<a name="l00314"></a>00314     <span class="keywordflow">if</span>(!isreal){
<a name="l00315"></a>00315     imagesc_do(fig, nx,  ny, limit, pi, T_DOUBLE, color,title, xlabel, ylabel,
<a name="l00316"></a>00316            <span class="stringliteral">"%s phi"</span>,fn);
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318     free(pi);
<a name="l00319"></a>00319 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8a0546beadad0f5031ad5e2160be53a9"></a><!-- doxytag: member="draw.c::ddraw" ref="8a0546beadad0f5031ad5e2160be53a9" args="(char *fig, const dmat *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ddraw           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdmat.html">dmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping the floating point numbers onto screen with scaling similar to matlab imagesc. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00339"></a>00339                               {
<a name="l00340"></a>00340  
<a name="l00341"></a>00341     format2fn;
<a name="l00342"></a>00342     (void)fig;
<a name="l00343"></a>00343     (void)A;
<a name="l00344"></a>00344     <a class="code" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f" title="Draw the OPD of double p defined on nx*ny grid.">imagesc</a>(fig,A-&gt;<a class="code" href="structdmat.html#983086836d817046db8588de2873dd36" title="number of rows">nx</a>,A-&gt;<a class="code" href="structdmat.html#690854282ff0f4fbd5d734d6c377c9b2" title="number of columns">ny</a>,NULL,A-&gt;<a class="code" href="structdmat.html#653d0780e19f58a3f74ead17630d9dcb" title="the pointer to allocated memory.">p</a>,1,title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00345"></a>00345 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d6a00fdf1415088dc897f3065b4f9c2d"></a><!-- doxytag: member="draw.c::cdrawabs" ref="d6a00fdf1415088dc897f3065b4f9c2d" args="(char *fig, const cmat *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cdrawabs           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping the absolution value of complex array. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00351"></a>00351                                  {
<a name="l00352"></a>00352   
<a name="l00353"></a>00353     format2fn;
<a name="l00354"></a>00354     (void)fig;
<a name="l00355"></a>00355     (void)A;
<a name="l00356"></a>00356     <a class="code" href="draw_8c.html#5bcab75037640d1cb5941078f857dae7" title="Draw the OPD of abs of complex p defined on nx*ny grid.">imagesc_cmp</a>(fig,A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>,A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>,NULL,A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,1,title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00357"></a>00357 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="07222a8a78a714cf79af93eba4c69cdc"></a><!-- doxytag: member="draw.c::cdrawri" ref="07222a8a78a714cf79af93eba4c69cdc" args="(char *fig, const cmat *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cdrawri           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping the real/imaginary part of complex array. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00364"></a>00364                                 {
<a name="l00365"></a>00365     
<a name="l00366"></a>00366     format2fn;
<a name="l00367"></a>00367     (void)fig;
<a name="l00368"></a>00368     (void)A;
<a name="l00369"></a>00369     <a class="code" href="draw_8c.html#6d3db72deaecd3bf018163252986c633" title="Draw the OPD of real and imaginary of complex p defined on nx*ny grid.">imagesc_cmp_ri</a>(fig,A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>,A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>,NULL,A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,1,title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00370"></a>00370 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c1cda6738a5ee34ed11eee39829cf690"></a><!-- doxytag: member="draw.c::cdraw" ref="c1cda6738a5ee34ed11eee39829cf690" args="(char *fig, const cmat *A, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cdraw           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Mapping the absolute and phase of complex array. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00377"></a>00377                               {
<a name="l00378"></a>00378     format2fn;
<a name="l00379"></a>00379     (void)fig;
<a name="l00380"></a>00380     (void)A;
<a name="l00381"></a>00381     <a class="code" href="draw_8c.html#2e0f8dbda688cfa30e822aa38a35a240" title="Draw the OPD of abs and phase of complex p defined on nx*ny grid.">imagesc_cmp_ap</a>(fig,A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>,A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>,NULL,A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,1,title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00382"></a>00382 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="cd04347e8f08fcef0e42ee57056d32ed"></a><!-- doxytag: member="draw.c::drawmap" ref="cd04347e8f08fcef0e42ee57056d32ed" args="(char *fig, const MAP_T *map, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawmap           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMAP__T.html">MAP_T</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
like ddraw, acting on sqmap object. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00389"></a>00389                                 {
<a name="l00390"></a>00390     format2fn;
<a name="l00391"></a>00391     (void)fig;
<a name="l00392"></a>00392     (void)map;
<a name="l00393"></a>00393     <span class="keywordtype">double</span> limit[4];
<a name="l00394"></a>00394     limit[0]=map-&gt;<a class="code" href="structMAP__T.html#6d09f5bfa663ca7cc80fa16cd4f3bc5c" title="Origin in x.">ox</a>-map-&gt;<a class="code" href="structMAP__T.html#49015864cb8861d6ecf4b6a88596ee3c" title="Sampling along x and y.">dx</a>/2;
<a name="l00395"></a>00395     limit[1]=map-&gt;<a class="code" href="structMAP__T.html#6d09f5bfa663ca7cc80fa16cd4f3bc5c" title="Origin in x.">ox</a>+(map-&gt;<a class="code" href="structMAP__T.html#e7003c76b669b6547f0cf76883e4ae9e" title="Number of points along x.">nx</a>-0.5)*map-&gt;<a class="code" href="structMAP__T.html#49015864cb8861d6ecf4b6a88596ee3c" title="Sampling along x and y.">dx</a>;
<a name="l00396"></a>00396     limit[2]=map-&gt;<a class="code" href="structMAP__T.html#edda94fda911d8718b7b25a3972aa23b" title="Origin in y.">oy</a>-map-&gt;<a class="code" href="structMAP__T.html#49015864cb8861d6ecf4b6a88596ee3c" title="Sampling along x and y.">dx</a>/2;
<a name="l00397"></a>00397     limit[3]=map-&gt;<a class="code" href="structMAP__T.html#edda94fda911d8718b7b25a3972aa23b" title="Origin in y.">oy</a>+(map-&gt;<a class="code" href="structMAP__T.html#122764d79d9e115f057f73f38f26b0b8" title="Number of points along y.">ny</a>-0.5)*map-&gt;<a class="code" href="structMAP__T.html#49015864cb8861d6ecf4b6a88596ee3c" title="Sampling along x and y.">dx</a>;
<a name="l00398"></a>00398     <a class="code" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f" title="Draw the OPD of double p defined on nx*ny grid.">imagesc</a>(fig, map-&gt;<a class="code" href="structMAP__T.html#e7003c76b669b6547f0cf76883e4ae9e" title="Number of points along x.">nx</a>, map-&gt;<a class="code" href="structMAP__T.html#122764d79d9e115f057f73f38f26b0b8" title="Number of points along y.">ny</a>, limit, map-&gt;<a class="code" href="structMAP__T.html#5d370c46ec22b469f87691d90a855030" title="The OPD.">p</a>, 1, title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00399"></a>00399 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="afc781f35ce1954a3041bf4d30e19384"></a><!-- doxytag: member="draw.c::drawloc" ref="afc781f35ce1954a3041bf4d30e19384" args="(char *fig, LOC_T *loc, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawloc           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLOC__T.html">LOC_T</a> *&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Plot the loc on the screen. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00405"></a>00405                                 {
<a name="l00406"></a>00406     format2fn;
<a name="l00407"></a>00407     <a class="code" href="loc_8c.html#4d37a2dfb2ce138d1d72772d5ff5a7ed" title="Create a map for loc so that we can obtain the index in loc by x,y coordinate.">loc_create_map_npad</a>(loc,0);
<a name="l00408"></a>00408     <span class="keywordtype">int</span> npad=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#89c4aea060b2dfe96b0e5f095f79d98c" title="Padding along the boundary.">npad</a>;
<a name="l00409"></a>00409     <span class="keywordtype">int</span> nxm=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>;
<a name="l00410"></a>00410     <span class="keywordtype">int</span> nx=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>-npad*2;
<a name="l00411"></a>00411     <span class="keywordtype">int</span> ny=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#95b172b2813350e28f6f20c3effa2b2e" title="Number of points along y.">ny</a>-npad*2;
<a name="l00412"></a>00412     <span class="keywordtype">double</span> *opd0=calloc(nx*ny, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00413"></a>00413     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy=0; iy&lt;ny; iy++){
<a name="l00414"></a>00414     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix=0; ix&lt;nx; ix++){
<a name="l00415"></a>00415         opd0[ix+iy*nx]=(loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a6884f997b7bf3fc1406b6fe4e6ff44b" title="The map, of size nx*ny.">p</a>[(ix+npad)+(iy+npad)*nxm]&gt;0);
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418     <span class="keywordtype">double</span> limit[4];
<a name="l00419"></a>00419     limit[0]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00420"></a>00420     limit[1]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(nx+npad-1/2);
<a name="l00421"></a>00421     limit[2]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00422"></a>00422     limit[3]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(ny+npad-1/2);
<a name="l00423"></a>00423     <a class="code" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f" title="Draw the OPD of double p defined on nx*ny grid.">imagesc</a>(fig, nx, ny,limit,opd0, 1, title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00424"></a>00424     free(opd0);
<a name="l00425"></a>00425 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ea2a96b41c5f08d3929a3f451e46feb3"></a><!-- doxytag: member="draw.c::drawopd" ref="ea2a96b41c5f08d3929a3f451e46feb3" args="(char *fig, LOC_T *loc, const double *opd, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawopd           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLOC__T.html">LOC_T</a> *&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>opd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Plot the opd using coordinate loc. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00432"></a>00432                                 {
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     format2fn;
<a name="l00435"></a>00435     <a class="code" href="loc_8c.html#4d37a2dfb2ce138d1d72772d5ff5a7ed" title="Create a map for loc so that we can obtain the index in loc by x,y coordinate.">loc_create_map_npad</a>(loc,0);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     <span class="keywordtype">int</span> npad=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#89c4aea060b2dfe96b0e5f095f79d98c" title="Padding along the boundary.">npad</a>;
<a name="l00438"></a>00438     <span class="keywordtype">int</span> nxm=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>;
<a name="l00439"></a>00439     <span class="keywordtype">int</span> nx=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>-npad*2;
<a name="l00440"></a>00440     <span class="keywordtype">int</span> ny=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#95b172b2813350e28f6f20c3effa2b2e" title="Number of points along y.">ny</a>-npad*2;
<a name="l00441"></a>00441     <span class="keywordtype">double</span> *opd0=calloc(nx*ny, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00442"></a>00442     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy=0; iy&lt;ny; iy++){
<a name="l00443"></a>00443     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix=0; ix&lt;nx; ix++){
<a name="l00444"></a>00444         <span class="keywordtype">int</span> ii=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a6884f997b7bf3fc1406b6fe4e6ff44b" title="The map, of size nx*ny.">p</a>[(ix+npad)+(iy+npad)*nxm];
<a name="l00445"></a>00445         <span class="keywordflow">if</span>(ii){
<a name="l00446"></a>00446         opd0[ix+iy*nx]=opd[ii-1];
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450     <span class="keywordtype">double</span> limit[4];
<a name="l00451"></a>00451     limit[0]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00452"></a>00452     limit[1]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(nx+npad-1/2);
<a name="l00453"></a>00453     limit[2]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00454"></a>00454     limit[3]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(ny+npad-1/2);
<a name="l00455"></a>00455     <a class="code" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f" title="Draw the OPD of double p defined on nx*ny grid.">imagesc</a>(fig,nx,ny, limit,opd0, 1, title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00456"></a>00456     free(opd0);
<a name="l00457"></a>00457 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0aaab8cf8f5f9fa84865586e1f70722b"></a><!-- doxytag: member="draw.c::drawopdamp" ref="0aaab8cf8f5f9fa84865586e1f70722b" args="(char *fig, LOC_T *loc, const double *opd, const double *amp, const char *title, const char *xlabel, const char *ylabel, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawopdamp           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLOC__T.html">LOC_T</a> *&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>opd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>amp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>xlabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ylabel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Plot opd*amp with coordinate loc. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00463"></a>00463                                {
<a name="l00464"></a>00464     format2fn;
<a name="l00465"></a>00465     (void)fig;
<a name="l00466"></a>00466     <a class="code" href="loc_8c.html#4d37a2dfb2ce138d1d72772d5ff5a7ed" title="Create a map for loc so that we can obtain the index in loc by x,y coordinate.">loc_create_map_npad</a>(loc,0);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468     <span class="keywordtype">int</span> npad=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#89c4aea060b2dfe96b0e5f095f79d98c" title="Padding along the boundary.">npad</a>;
<a name="l00469"></a>00469     <span class="keywordtype">int</span> nxm=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>;
<a name="l00470"></a>00470     <span class="keywordtype">int</span> nx=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a53b9f6a08b042a3aa5333de8ff4598d" title="Number of points along x.">nx</a>-npad*2;
<a name="l00471"></a>00471     <span class="keywordtype">int</span> ny=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#95b172b2813350e28f6f20c3effa2b2e" title="Number of points along y.">ny</a>-npad*2;
<a name="l00472"></a>00472     <span class="keywordtype">double</span> *opd0=calloc(nx*ny, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00473"></a>00473     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy=0; iy&lt;ny; iy++){
<a name="l00474"></a>00474     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix=0; ix&lt;nx; ix++){
<a name="l00475"></a>00475         <span class="keywordtype">int</span> ii=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a6884f997b7bf3fc1406b6fe4e6ff44b" title="The map, of size nx*ny.">p</a>[(ix+npad)+(iy+npad)*nxm];
<a name="l00476"></a>00476         <span class="keywordflow">if</span>(ii){
<a name="l00477"></a>00477         ii--;
<a name="l00478"></a>00478         opd0[ix+iy*nx]=opd[ii]*amp[ii];
<a name="l00479"></a>00479         }
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482     <span class="keywordtype">double</span> limit[4];
<a name="l00483"></a>00483     limit[0]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00484"></a>00484     limit[1]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#a035d06a3ddd28ba504f54434970d471" title="Origin of the map along x.">ox</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(nx+npad-1/2);
<a name="l00485"></a>00485     limit[2]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(npad-1/2);
<a name="l00486"></a>00486     limit[3]=loc-&gt;<a class="code" href="structLOC__T.html#72938c54993e6e9d0b00bb211d66f2d1" title="point to the map used for identifying neihboring points.">map</a>-&gt;<a class="code" href="structLOCMAP__T.html#0a28d333e471c48f6955517e9106fb49" title="Origin of the map along y.">oy</a>+loc-&gt;<a class="code" href="structLOC__T.html#ae9e38522a793c7d018028a38fc34ce0" title="Sampling.">dx</a>*(ny+npad-1/2);
<a name="l00487"></a>00487     <a class="code" href="draw_8c.html#9cb7ab0234de01be82e2386ea09d342f" title="Draw the OPD of double p defined on nx*ny grid.">imagesc</a>(fig, nx,ny,limit, opd0, 1, title, xlabel, ylabel,<span class="stringliteral">"%s"</span>,fn);
<a name="l00488"></a>00488     free(opd0);
<a name="l00489"></a>00489 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="64bf220e2fe22080f5976cb7b451cc8e"></a><!-- doxytag: member="draw.c::bin" ref="64bf220e2fe22080f5976cb7b451cc8e" args="(long nx, long ny, double *restrict p, int factor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* bin           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>factor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
bin a double matrix from nx*ny to (nx/factor)*(ny*factor) 
<p>
<div class="fragment"><pre class="fragment"><a name="l00494"></a>00494                                                              {
<a name="l00495"></a>00495   
<a name="l00496"></a>00496     <span class="keywordtype">long</span> nxnew=nx/factor;
<a name="l00497"></a>00497     <span class="keywordtype">long</span> nynew=ny/factor;
<a name="l00498"></a>00498     <span class="keywordtype">double</span> *pnew=calloc(nxnew*nynew, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00499"></a>00499     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;ny; j++){
<a name="l00500"></a>00500     <span class="keywordtype">double</span> *p2=p+j*nx;
<a name="l00501"></a>00501     <span class="keywordtype">double</span> *pnew2=pnew+(j/factor)*nxnew;
<a name="l00502"></a>00502     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> i=0; i&lt;nxnew; i++){
<a name="l00503"></a>00503         <span class="keywordflow">for</span>(<span class="keywordtype">long</span> i2=0; i2&lt;factor; i2++){
<a name="l00504"></a>00504         pnew2[i]+=p2[i*factor+i2];
<a name="l00505"></a>00505         }
<a name="l00506"></a>00506     }
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508     <span class="keywordflow">return</span> pnew;
<a name="l00509"></a>00509 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="19282078024715081530a34a20ae7f02"></a><!-- doxytag: member="draw.c::crp" ref="19282078024715081530a34a20ae7f02" args="(double x, double x0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int crp           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x0</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert double to int 
<p>
<div class="fragment"><pre class="fragment"><a name="l00513"></a>00513                                             {
<a name="l00514"></a>00514     <span class="keywordtype">double</span> res=1.5-4.*fabs(x-x0);
<a name="l00515"></a>00515     <span class="keywordflow">if</span>(res&gt;1) res=1.;
<a name="l00516"></a>00516     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(res &lt;0) res=0.;
<a name="l00517"></a>00517     <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(res*255.);
<a name="l00518"></a>00518     <span class="comment">//fprintf(stderr,"x=%g, x0=%g, res=%g\n",x, x0, res);</span>
<a name="l00519"></a>00519     <span class="comment">//return a;</span>
<a name="l00520"></a>00520 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="946198fe3c1a7c7c5a91982808f90926"></a><!-- doxytag: member="draw.c::dbl2gray" ref="946198fe3c1a7c7c5a91982808f90926" args="(long nx, long ny, const double *restrict p, unsigned char *pc, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dbl2gray           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert double to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00524"></a>00524                                           {
<a name="l00525"></a>00525     <span class="keywordtype">double</span> max,min,sum;
<a name="l00526"></a>00526     maxmindbl(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00527"></a>00527     <span class="keywordtype">double</span> scale=255./(max-min);
<a name="l00528"></a>00528     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00529"></a>00529     pc[i]=(<span class="keywordtype">unsigned</span> char)((p[i]-min)*scale);
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531     info[0]=max; info[1]=min; info[2]=sum;
<a name="l00532"></a>00532 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="130b2012a152d0a74d99fb163e0a44eb"></a><!-- doxytag: member="draw.c::long2gray" ref="130b2012a152d0a74d99fb163e0a44eb" args="(long nx, long ny, const long *restrict p, unsigned char *pc, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void long2gray           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert long to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00536"></a>00536                                            {
<a name="l00537"></a>00537     <span class="keywordtype">long</span> max,min,sum;
<a name="l00538"></a>00538     maxminlong(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00539"></a>00539     <span class="keywordtype">double</span> scale=255./(max-min);
<a name="l00540"></a>00540     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00541"></a>00541     pc[i]=(<span class="keywordtype">unsigned</span> char)((<span class="keywordtype">double</span>)(p[i]-min)*scale);
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543     info[0]=(double)max; info[1]=(double)min; info[2]=(double)sum;
<a name="l00544"></a>00544 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bdf3def1b58a1af325454ac890988543"></a><!-- doxytag: member="draw.c::cmp2gray" ref="bdf3def1b58a1af325454ac890988543" args="(long nx, long ny, const dcomplex *restrict p, unsigned char *pc, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cmp2gray           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert complex to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00548"></a>00548                                           {
<a name="l00549"></a>00549     <span class="keywordtype">double</span> max,min,sum;
<a name="l00550"></a>00550     maxmincmp(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00551"></a>00551     <span class="keywordtype">double</span> scale=255./(max-min);
<a name="l00552"></a>00552     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00553"></a>00553     pc[i]=(<span class="keywordtype">unsigned</span> char)((cabs(p[i])-min)*scale);
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555     info[0]=max; info[1]=min; info[2]=sum;
<a name="l00556"></a>00556 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6aca171c6c895b50927f847817d42985"></a><!-- doxytag: member="draw.c::dbl2rgb" ref="6aca171c6c895b50927f847817d42985" args="(long nx, long ny, const double *restrict p, int *pi, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dbl2rgb           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert double to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00560"></a>00560                                {
<a name="l00561"></a>00561     <span class="comment">//convert using maplab colormap.</span>
<a name="l00562"></a>00562     <span class="keywordtype">double</span> max,min,sum;
<a name="l00563"></a>00563     maxmindbl(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00564"></a>00564     <span class="keywordtype">double</span> scale,offset;
<a name="l00565"></a>00565     <span class="keywordflow">if</span>(fabs(max-min)&gt;1.e-4*fabs(min)){
<a name="l00566"></a>00566     scale=1./(max-min);
<a name="l00567"></a>00567     offset=0;
<a name="l00568"></a>00568     }<span class="keywordflow">else</span>{
<a name="l00569"></a>00569     scale=0;
<a name="l00570"></a>00570     offset=0.5;
<a name="l00571"></a>00571     }
<a name="l00572"></a>00572     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00573"></a>00573     <span class="keywordtype">double</span> x=(p[i]-min)*scale+offset;
<a name="l00574"></a>00574     pi[i]=<a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x,0.75)&lt;&lt;16 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.5)&lt;&lt;8 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.25);
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576     info[0]=max; info[1]=min; info[2]=sum;
<a name="l00577"></a>00577 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0f0efdf70b82ba86cacb8c873983f3a4"></a><!-- doxytag: member="draw.c::long2rgb" ref="0f0efdf70b82ba86cacb8c873983f3a4" args="(long nx, long ny, const long *restrict p, int *restrict pi, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void long2rgb           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *restrict&nbsp;</td>
          <td class="paramname"> <em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert long to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00581"></a>00581                                          {
<a name="l00582"></a>00582     <span class="comment">//convert using maplab colormap.</span>
<a name="l00583"></a>00583     <span class="keywordtype">long</span> max,min,sum;
<a name="l00584"></a>00584     maxminlong(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00585"></a>00585     <span class="keywordtype">double</span> scale=1./(max-min);
<a name="l00586"></a>00586     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00587"></a>00587     <span class="keywordtype">double</span> x=(p[i]-min)*scale;
<a name="l00588"></a>00588     pi[i]=<a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x,0.75)&lt;&lt;16 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.5)&lt;&lt;8 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.25);
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590     info[0]=(double)max; info[1]=(double)min; info[2]=(double)sum;
<a name="l00591"></a>00591 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b09bfb86fa6467aca41b4a0fd5d7a698"></a><!-- doxytag: member="draw.c::cmp2rgb" ref="b09bfb86fa6467aca41b4a0fd5d7a698" args="(long nx, long ny, const dcomplex *restrict p, int *pi, double *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cmp2rgb           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const dcomplex *restrict&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
convert complex to char with color map 
<p>
<div class="fragment"><pre class="fragment"><a name="l00595"></a>00595                                {
<a name="l00596"></a>00596     <span class="comment">//convert using maplab colormap.</span>
<a name="l00597"></a>00597     <span class="keywordtype">double</span> max,min,sum;
<a name="l00598"></a>00598     maxmincmp(p, nx*ny, &amp;max, &amp;min, &amp;sum);
<a name="l00599"></a>00599     <span class="keywordtype">double</span> scale=1./(max-min);
<a name="l00600"></a>00600     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nx*ny; i++){
<a name="l00601"></a>00601     <span class="keywordtype">double</span> x=(cabs(p[i])-min)*scale;
<a name="l00602"></a>00602     pi[i]=<a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x,0.75)&lt;&lt;16 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.5)&lt;&lt;8 | <a class="code" href="draw_8c.html#19282078024715081530a34a20ae7f02" title="convert double to int">crp</a>(x, 0.25);
<a name="l00603"></a>00603     }
<a name="l00604"></a>00604     info[0]=max; info[1]=min; info[2]=sum;
<a name="l00605"></a>00605 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 29 14:37:09 2010 for maos-0.6.4 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
