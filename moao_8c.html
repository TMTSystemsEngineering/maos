<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>maos-0.7.5: maos/moao.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>maos/moao.c File Reference</h1>Routings to setup moao and carry out moao DM fitting.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#c1922d6404880ae75380e8c876e55044">shift_ring</a> (int nap, <a class="el" href="structdmat.html">dmat</a> **ring, <a class="el" href="structdmat.html">dmat</a> *new)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cyclic shift the dmats.  <a href="#c1922d6404880ae75380e8c876e55044"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#aaf77736de33764e12edc12f46b18c64">free_recon_moao</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free <a class="el" href="structMOAO__T.html" title="contains MOAO related data">MOAO_T</a>.  <a href="#aaf77736de33764e12edc12f46b18c64"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#c70e508023f8816854d7d4eaf0452aa6">setup_recon_moao</a> (<a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare the propagation H matrix for MOAO and compute the reconstructor.  <a href="#c70e508023f8816854d7d4eaf0452aa6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#5a08339d5c9a918e99995b4dd016aa91">moao_FitR</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const <a class="el" href="structRECON__T.html">RECON_T</a> *recon, const <a class="el" href="structPARMS__T.html">PARMS_T</a> *parms, int imoao, double thetax, double thetay, double hs, const <a class="el" href="structdcell.html">dcell</a> *opdr, const <a class="el" href="structdcell.html">dcell</a> *dmcommon, <a class="el" href="structdcell.html">dcell</a> **rhsout, const double alpha)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply fit right hand side matrix in CG mode without using assembled matrix for MOAO.  <a href="#5a08339d5c9a918e99995b4dd016aa91"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#f3f1b61e90e1b7f99f0ef80960511f8b">moao_FitL</a> (<a class="el" href="structdcell.html">dcell</a> **xout, const void *A, const <a class="el" href="structdcell.html">dcell</a> *xin, const double alpha)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply fit left hand side matrix in CG mode without using assembled matrix.  <a href="#f3f1b61e90e1b7f99f0ef80960511f8b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="moao_8c.html#f62a4685464fea7bdd37d04c821c3caf">moao_recon</a> (<a class="el" href="structSIM__T.html">SIM_T</a> *simu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mao_recon happens after the common DM fitting and its integrator output to take into account the delay in DM commands.  <a href="#f62a4685464fea7bdd37d04c821c3caf"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Routings to setup moao and carry out moao DM fitting. 
<p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c1922d6404880ae75380e8c876e55044"></a><!-- doxytag: member="moao.c::shift_ring" ref="c1922d6404880ae75380e8c876e55044" args="(int nap, dmat **ring, dmat *new)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void shift_ring           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> **&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdmat.html">dmat</a> *&nbsp;</td>
          <td class="paramname"> <em>new</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
cyclic shift the dmats. 
<p>

</div>
</div><p>
<a class="anchor" name="aaf77736de33764e12edc12f46b18c64"></a><!-- doxytag: member="moao.c::free_recon_moao" ref="aaf77736de33764e12edc12f46b18c64" args="(RECON_T *recon, const PARMS_T *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_recon_moao           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&nbsp;</td>
          <td class="paramname"> <em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free <a class="el" href="structMOAO__T.html" title="contains MOAO related data">MOAO_T</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="c70e508023f8816854d7d4eaf0452aa6"></a><!-- doxytag: member="moao.c::setup_recon_moao" ref="c70e508023f8816854d7d4eaf0452aa6" args="(RECON_T *recon, const PARMS_T *parms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_recon_moao           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRECON__T.html">RECON_T</a> *&nbsp;</td>
          <td class="paramname"> <em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prepare the propagation H matrix for MOAO and compute the reconstructor. 
<p>
We only need a reconstructor for every different MOAO type. 
</div>
</div><p>
<a class="anchor" name="5a08339d5c9a918e99995b4dd016aa91"></a><!-- doxytag: member="moao.c::moao_FitR" ref="5a08339d5c9a918e99995b4dd016aa91" args="(dcell **xout, const RECON_T *recon, const PARMS_T *parms, int imoao, double thetax, double thetay, double hs, const dcell *opdr, const dcell *dmcommon, dcell **rhsout, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void moao_FitR           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&nbsp;</td>
          <td class="paramname"> <em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structRECON__T.html">RECON_T</a> *&nbsp;</td>
          <td class="paramname"> <em>recon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPARMS__T.html">PARMS_T</a> *&nbsp;</td>
          <td class="paramname"> <em>parms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>imoao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thetax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thetay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&nbsp;</td>
          <td class="paramname"> <em>opdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&nbsp;</td>
          <td class="paramname"> <em>dmcommon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&nbsp;</td>
          <td class="paramname"> <em>rhsout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Apply fit right hand side matrix in CG mode without using assembled matrix for MOAO. 
<p>
subtract contributions from DMs that are in common path. Be careful which time step the dmcommon is. The DM common should use the commands on the step that you are going to apply the MOAO command for. That is the integrator output after this computation. 
</div>
</div><p>
<a class="anchor" name="f3f1b61e90e1b7f99f0ef80960511f8b"></a><!-- doxytag: member="moao.c::moao_FitL" ref="f3f1b61e90e1b7f99f0ef80960511f8b" args="(dcell **xout, const void *A, const dcell *xin, const double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void moao_FitL           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdcell.html">dcell</a> **&nbsp;</td>
          <td class="paramname"> <em>xout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdcell.html">dcell</a> *&nbsp;</td>
          <td class="paramname"> <em>xin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Apply fit left hand side matrix in CG mode without using assembled matrix. 
<p>
Slow. don't use. Assembled matridx is faster because of multiple directions. 
</div>
</div><p>
<a class="anchor" name="f62a4685464fea7bdd37d04c821c3caf"></a><!-- doxytag: member="moao.c::moao_recon" ref="f62a4685464fea7bdd37d04c821c3caf" args="(SIM_T *simu)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moao_recon           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSIM__T.html">SIM_T</a> *&nbsp;</td>
          <td class="paramname"> <em>simu</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
mao_recon happens after the common DM fitting and its integrator output to take into account the delay in DM commands. 
<p>
there is no close loop filtering in MOAO DM commands, but there is still a time delay of 2 cycles. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Nov 24 14:46:54 2010 for maos-0.7.5 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
