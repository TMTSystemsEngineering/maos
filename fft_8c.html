<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>maos-0.7.0: lib/fft.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/fft.c File Reference</h1>Routines to do FFT on <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2725611a27bba450e4b17592425a0b3b"></a><!-- doxytag: member="fft.c::USE_COMPLEX" ref="2725611a27bba450e4b17592425a0b3b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>USE_COMPLEX</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8a8f75f08ed7e1844893c3c8ae8bb821"></a><!-- doxytag: member="fft.c::LOCK_FFT" ref="8a8f75f08ed7e1844893c3c8ae8bb821" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>LOCK_FFT</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="46cd5810acdabad3f9ac588daa499e41"></a><!-- doxytag: member="fft.c::UNLOCK_FFT" ref="46cd5810acdabad3f9ac588daa499e41" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>UNLOCK_FFT</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d29c473e8092e74b618143e8c477877b"></a><!-- doxytag: member="fft.c::FFTW_FLAGS" ref="d29c473e8092e74b618143e8c477877b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>FFTW_FLAGS</b></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4243bb33db65def52e5bae657029569e"></a><!-- doxytag: member="fft.c::load_plan" ref="4243bb33db65def52e5bae657029569e" args="()" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><b>load_plan</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="febe0a3a5baf31e6f4644eb5a24a9e45"></a><!-- doxytag: member="fft.c::save_plan" ref="febe0a3a5baf31e6f4644eb5a24a9e45" args="()" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><b>save_plan</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9ed16867a9394d9ccf1132194edae298"></a><!-- doxytag: member="fft.c::__attribute__" ref="9ed16867a9394d9ccf1132194edae298" args="((constructor))" -->
static&nbsp;</td><td class="memItemRight" valign="bottom"><b>__attribute__</b> ((constructor))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7f400e70d869030323eab6b41ab8e833"></a><!-- doxytag: member="fft.c::__attribute__" ref="7f400e70d869030323eab6b41ab8e833" args="((destructor))" -->
static&nbsp;</td><td class="memItemRight" valign="bottom"><b>__attribute__</b> ((destructor))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#8b872386a7d070a175aa54dadcf2c68e">cfft2plan</a> (<a class="el" href="structcmat.html">cmat</a> *A, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create FFTW plans for 2d FFT transforms.  <a href="#8b872386a7d070a175aa54dadcf2c68e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#c952e6cd84358728122ec12213811b90">cfft2partialplan</a> (<a class="el" href="structcmat.html">cmat</a> *A, int ncomp, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make plans for cfft2partial  <a href="#c952e6cd84358728122ec12213811b90"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#1752744dba77b7791b1a629eab4ca99e">cfree_plan</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free FFTW plans.  <a href="#1752744dba77b7791b1a629eab4ca99e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#5e22d51b30da1c5c057cb5b8f121273d">cfft2</a> (<a class="el" href="structcmat.html">cmat</a> *A, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do 2d FFT transforms.  <a href="#5e22d51b30da1c5c057cb5b8f121273d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#b773d97e4de22b835cebd7b622f60ee2">cifft2</a> (<a class="el" href="structcmat.html">cmat</a> *A, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do 2d inverse FFT (scaling factor of 1/(nx*ny) is applied).  <a href="#b773d97e4de22b835cebd7b622f60ee2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#9ee95d19c60ca917f6f61708ff6544b6">cfft2s</a> (<a class="el" href="structcmat.html">cmat</a> *A, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do 2d FFT transforms and scale the output by 1/sqrt(nx*ny).  <a href="#9ee95d19c60ca917f6f61708ff6544b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#b3159a1cba08cacee28341ac4fc74cd9">cfft2partial</a> (<a class="el" href="structcmat.html">cmat</a> *A, int ncomp, int dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply 2d FFT partially over ncomp <img class="formulaInl" alt="$\times$" src="form_5.png">ncomp region use two 1d plans that takes 1d fft through its column and selectly for its rows to produce smaller psf.  <a href="#b3159a1cba08cacee28341ac4fc74cd9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fft_8c.html#7b04bda35e161da1cb91a619fcf46829">cffttreat</a> (<a class="el" href="structcmat.html">cmat</a> *A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns IFFT(fftshift(FFT(A)))  <a href="#7b04bda35e161da1cb91a619fcf46829"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Routines to do FFT on <a class="el" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a>. 
<p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8b872386a7d070a175aa54dadcf2c68e"></a><!-- doxytag: member="fft.c::cfft2plan" ref="8b872386a7d070a175aa54dadcf2c68e" args="(cmat *A, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfft2plan           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create FFTW plans for 2d FFT transforms. 
<p>
This operation destroyes the data in the array. So do it before filling in data. <div class="fragment"><pre class="fragment"><a name="l00059"></a>00059                                 {
<a name="l00060"></a>00060     assert(abs(dir)==1);
<a name="l00061"></a>00061     assert(A &amp;&amp; A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a> &amp;&amp; !A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[dir+1]);
<a name="l00062"></a>00062     LOCK_FFT;<span class="comment"></span>
<a name="l00063"></a>00063 <span class="comment">    //!!fft uses row major mode. so need to reverse order</span>
<a name="l00064"></a>00064 <span class="comment"></span>    <span class="keywordflow">if</span>(A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>==1 || A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>==1){
<a name="l00065"></a>00065     A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[dir+1]=fftw_plan_dft_1d(A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>*A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>, A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>, A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>, dir, FFTW_FLAGS);
<a name="l00066"></a>00066     }<span class="keywordflow">else</span>{
<a name="l00067"></a>00067     A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[dir+1]=fftw_plan_dft_2d(A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>, A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>, A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>, A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>, dir, FFTW_FLAGS);
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069     UNLOCK_FFT;  
<a name="l00070"></a>00070 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c952e6cd84358728122ec12213811b90"></a><!-- doxytag: member="fft.c::cfft2partialplan" ref="c952e6cd84358728122ec12213811b90" args="(cmat *A, int ncomp, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfft2partialplan           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
make plans for cfft2partial 
<p>
<div class="fragment"><pre class="fragment"><a name="l00075"></a>00075                                                   {
<a name="l00076"></a>00076     assert(abs(dir)==1);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keyword">const</span> <span class="keywordtype">int</span> nx=A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>;
<a name="l00079"></a>00079     <span class="keyword">const</span> <span class="keywordtype">int</span> ny=A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>;
<a name="l00080"></a>00080     <a class="code" href="structPLAN1D__T.html" title="An arrays of 1-d plans that are used to do 2-d FFTs only over specified region.">PLAN1D_T</a> *plan1d=A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[dir+1]=calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="structPLAN1D__T.html" title="An arrays of 1-d plans that are used to do 2-d FFTs only over specified region.">PLAN1D_T</a>));
<a name="l00081"></a>00081     LOCK_FFT;
<a name="l00082"></a>00082     <span class="comment">//along columns for all columns.</span>
<a name="l00083"></a>00083     plan1d-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[0]=fftw_plan_many_dft(1, &amp;nx, ny,
<a name="l00084"></a>00084                        A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,NULL,1,nx,
<a name="l00085"></a>00085                        A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,NULL,1,nx,
<a name="l00086"></a>00086                        dir,FFTW_FLAGS);
<a name="l00087"></a>00087     <span class="comment">//selected along rows, beginning</span>
<a name="l00088"></a>00088     plan1d-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[1]=fftw_plan_many_dft(1, &amp;ny, ncomp/2,
<a name="l00089"></a>00089                        A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,NULL,nx,1,
<a name="l00090"></a>00090                        A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>,NULL,nx,1,
<a name="l00091"></a>00091                        dir,FFTW_FLAGS);
<a name="l00092"></a>00092     <span class="comment">//selected along rows, end</span>
<a name="l00093"></a>00093     plan1d-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[2]=fftw_plan_many_dft(1,&amp;ny,ncomp/2, 
<a name="l00094"></a>00094                  A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>+nx-ncomp/2,NULL,nx,1,
<a name="l00095"></a>00095                  A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>+nx-ncomp/2,NULL,nx,1,
<a name="l00096"></a>00096                  dir,FFTW_FLAGS);
<a name="l00097"></a>00097     UNLOCK_FFT; 
<a name="l00098"></a>00098     plan1d-&gt;<a class="code" href="structPLAN1D__T.html#06fc40b220c0e124d742130b20795a5f" title="For a NxN array, only convert center ncomp*ncomp to Fourier space.">ncomp</a>=ncomp;
<a name="l00099"></a>00099 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1752744dba77b7791b1a629eab4ca99e"></a><!-- doxytag: member="fft.c::cfree_plan" ref="1752744dba77b7791b1a629eab4ca99e" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfree_plan           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free FFTW plans. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00103"></a>00103                         {
<a name="l00104"></a>00104     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> idir=-1; idir&lt;2; idir+=2){
<a name="l00105"></a>00105     <span class="keywordflow">if</span>(A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[idir+1]){
<a name="l00106"></a>00106         LOCK_FFT;
<a name="l00107"></a>00107         fftw_destroy_plan(A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[idir+1]-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[0]);
<a name="l00108"></a>00108         fftw_destroy_plan(A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[idir+1]-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[1]);
<a name="l00109"></a>00109         fftw_destroy_plan(A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[idir+1]-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[2]);
<a name="l00110"></a>00110         free(A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[idir+1]);
<a name="l00111"></a>00111         UNLOCK_FFT;
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113     <span class="keywordflow">if</span>(A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[idir+1]){
<a name="l00114"></a>00114         fftw_destroy_plan(A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[idir+1]);
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e22d51b30da1c5c057cb5b8f121273d"></a><!-- doxytag: member="fft.c::cfft2" ref="5e22d51b30da1c5c057cb5b8f121273d" args="(cmat *A, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfft2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Do 2d FFT transforms. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00121"></a>00121                             {
<a name="l00122"></a>00122     assert(abs(dir)==1); assert(A &amp;&amp; A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>);
<a name="l00123"></a>00123     <span class="comment">//do 2d FFT on A.</span>
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     dir++;
<a name="l00126"></a>00126     <span class="comment">//can not do planning here because planning will override the data.</span>
<a name="l00127"></a>00127     <span class="keywordflow">if</span>(!A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[dir]) error(<span class="stringliteral">"Please run cfft2plan first\n"</span>);
<a name="l00128"></a>00128     fftw_execute(A-&gt;<a class="code" href="structcmat.html#3ef4a389d46b981f86a90429b5e67036" title="Stores array of FFT plans for forward and backward FFT.">plan</a>[dir]);
<a name="l00129"></a>00129 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b773d97e4de22b835cebd7b622f60ee2"></a><!-- doxytag: member="fft.c::cifft2" ref="b773d97e4de22b835cebd7b622f60ee2" args="(cmat *A, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cifft2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Do 2d inverse FFT (scaling factor of 1/(nx*ny) is applied). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00134"></a>00134                              {
<a name="l00135"></a>00135     <span class="comment">/*Apply scaling factor*/</span>
<a name="l00136"></a>00136     <a class="code" href="fft_8c.html#5e22d51b30da1c5c057cb5b8f121273d" title="Do 2d FFT transforms.">cfft2</a>(A,dir);
<a name="l00137"></a>00137     <a class="code" href="cmat_8h.html#204751357459432e00c5f5ee8d261f56" title="scale each element of A by w">cscale</a>(A,1./(<span class="keywordtype">double</span>)(A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>*A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>));
<a name="l00138"></a>00138 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9ee95d19c60ca917f6f61708ff6544b6"></a><!-- doxytag: member="fft.c::cfft2s" ref="9ee95d19c60ca917f6f61708ff6544b6" args="(cmat *A, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfft2s           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Do 2d FFT transforms and scale the output by 1/sqrt(nx*ny). 
<p>
<div class="fragment"><pre class="fragment"><a name="l00143"></a>00143                              {<span class="comment">//symmetrical cfft2.</span>
<a name="l00144"></a>00144     <a class="code" href="fft_8c.html#5e22d51b30da1c5c057cb5b8f121273d" title="Do 2d FFT transforms.">cfft2</a>(A,dir);
<a name="l00145"></a>00145     <a class="code" href="cmat_8h.html#204751357459432e00c5f5ee8d261f56" title="scale each element of A by w">cscale</a>(A,1./sqrt((<span class="keywordtype">double</span>)(A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>*A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>)));
<a name="l00146"></a>00146 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b3159a1cba08cacee28341ac4fc74cd9"></a><!-- doxytag: member="fft.c::cfft2partial" ref="b3159a1cba08cacee28341ac4fc74cd9" args="(cmat *A, int ncomp, int dir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfft2partial           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Apply 2d FFT partially over ncomp <img class="formulaInl" alt="$\times$" src="form_5.png">ncomp region use two 1d plans that takes 1d fft through its column and selectly for its rows to produce smaller psf. 
<p>
<div class="fragment"><pre class="fragment"><a name="l00153"></a>00153                                               {
<a name="l00154"></a>00154     assert(abs(dir)==1);
<a name="l00155"></a>00155     assert(A &amp;&amp; A-&gt;<a class="code" href="structcmat.html#8b3042714ec7576bcdb1204030e8532a" title="the pointer to allocated memory.">p</a>);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <a class="code" href="structPLAN1D__T.html" title="An arrays of 1-d plans that are used to do 2-d FFTs only over specified region.">PLAN1D_T</a> *plan1d=A-&gt;<a class="code" href="structcmat.html#6de605ddd78795d04e6ee5fc4e919536" title="Stores array of 1-D FFT plans.">plan1d</a>[dir+1];
<a name="l00158"></a>00158     <span class="keywordflow">if</span>(!plan1d) error(<span class="stringliteral">"Please run cfft2partialplan first\n"</span>);
<a name="l00159"></a>00159     <span class="keywordflow">if</span>(ncomp!=plan1d-&gt;<a class="code" href="structPLAN1D__T.html#06fc40b220c0e124d742130b20795a5f" title="For a NxN array, only convert center ncomp*ncomp to Fourier space.">ncomp</a>) error(<span class="stringliteral">"Plan and fft mismatch\n"</span>);
<a name="l00160"></a>00160     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; i++){
<a name="l00161"></a>00161     fftw_execute(plan1d-&gt;<a class="code" href="structPLAN1D__T.html#995545e2d41bcf74991946a3fe1e05a3" title="Array of plans for 1-d FFT.">plan</a>[i]);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7b04bda35e161da1cb91a619fcf46829"></a><!-- doxytag: member="fft.c::cffttreat" ref="7b04bda35e161da1cb91a619fcf46829" args="(cmat *A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcmat.html">cmat</a>* cffttreat           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmat.html">cmat</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
returns IFFT(fftshift(FFT(A))) 
<p>
<div class="fragment"><pre class="fragment"><a name="l00168"></a>00168                         {
<a name="l00169"></a>00169     <span class="keywordflow">if</span> (!A) <span class="keywordflow">return</span> NULL;
<a name="l00170"></a>00170     <a class="code" href="structcmat.html" title="a double complex matrix object contains 2-d arrays of double complex numbers.">cmat</a> *B=<a class="code" href="cmat_8h.html#bb2b86ffc48237c760e652708aaf1415" title="Create a new T matrix object.">cnew</a>(A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>, A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>);
<a name="l00171"></a>00171     <a class="code" href="fft_8c.html#8b872386a7d070a175aa54dadcf2c68e" title="Create FFTW plans for 2d FFT transforms.">cfft2plan</a>(B,1);
<a name="l00172"></a>00172     <a class="code" href="fft_8c.html#8b872386a7d070a175aa54dadcf2c68e" title="Create FFTW plans for 2d FFT transforms.">cfft2plan</a>(B,-1);
<a name="l00173"></a>00173     <a class="code" href="cmat_8h.html#db3c55ee96a9e7249403f738d251688c" title="copy the values from one X(mat) to another.">ccp</a>(&amp;B, A);
<a name="l00174"></a>00174     <a class="code" href="fft_8c.html#5e22d51b30da1c5c057cb5b8f121273d" title="Do 2d FFT transforms.">cfft2</a>(B,-1);
<a name="l00175"></a>00175     <a class="code" href="cmat_8h.html#2e68e24dcc5d7ffd8d9b2c575e0830b9" title="shift frequency components by n/2">cfftshift</a>(B);
<a name="l00176"></a>00176     <a class="code" href="fft_8c.html#5e22d51b30da1c5c057cb5b8f121273d" title="Do 2d FFT transforms.">cfft2</a>(B,1);
<a name="l00177"></a>00177     <a class="code" href="cmat_8h.html#204751357459432e00c5f5ee8d261f56" title="scale each element of A by w">cscale</a>(B,1./(<span class="keywordtype">double</span>)(A-&gt;<a class="code" href="structcmat.html#a4194b0fe36568f0dd5101cde603cb3c" title="number of rows">nx</a>*A-&gt;<a class="code" href="structcmat.html#f5f56097ef44115b7454dad413d6bba2" title="number of columns">ny</a>));
<a name="l00178"></a>00178     <span class="keywordflow">return</span> B;
<a name="l00179"></a>00179 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Oct 29 21:16:57 2010 for maos-0.7.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
