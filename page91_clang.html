<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>MAOS: Fundementals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="maos.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAOS
   </div>
   <div id="projectbrief">A Fast End to End Adaptive Optics Simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('page91_clang.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Fundementals </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The user is required to have a good understanding of the C fundementals, like the pointer, to study and improve the code. Here we list a few to remind the user.</p>
<h1><a class="anchor" id="sect-array"></a>
Memory Access</h1>
<p>If you declare an array: <code>double a[1024];</code> the symbol actually contains the address of a 1024x8 byte memory region that is automatically allocated in the stack (malloc, calloc allocations memory in the heap). Suppost the address of the memory region is 0xFF00. Assignment <code>a[0]=1;</code> puts 1 in memory started at 0xFF00. And <code>a[1]=1;</code> puts 1 in memory started at 0xFF08.</p>
<p>Stack is the memory region allocated dynamically when calling a function. All variables reside in stack automatically disappear when the function returns.</p>
<p>Heap is the memory reservoir that persists during the life time of the executable. The functions <code>malloc</code>, <code>calloc</code>, <code>realloc</code> reserves memory in the heap while <code>free</code> removes the reservation.</p>
<h2><a class="anchor" id="sect-pointer"></a>
Pointers</h2>
<p>A pointer is a variable that stores the address of a memory region. For example, <code>void *p;</code> is a basic pointer that just stores the address and can not do any thing about the memory it points to. Its value can be assigned to any other non const vector or from any vector (1d or 2d).</p>
<p>However, a normal pointer like <code>double *p;</code> also contains information about the memory it points to. More specifically, the compiler know the length of each element so that it can compute the address offset of the elements, just like arrays. For example: </p><pre class="fragment">double *p; //assume p=0xFF00.
p[0]=1;    //stores 1 into memory region at 0xFF00
p[1]=1;    //stores 1 into memory region at 0xFF08 because a double requires 8 bytes.
p=p+1;     //now p=0xFF08, i.e., points to the next element, instead of 0xFF01 
p[i]=1;    //is strictly equivalent to &lt;code&gt;*(p+i)=1;&lt;/code&gt; 
</pre><h2><a class="anchor" id="sect-1d-pointer"></a>
Array Pointers</h2>
<p>A pointer can be used to create and index an 1-dimensional (1-d) array in the heap: </p><pre class="fragment">double *p; //decleares a double array pointer.
p=calloc(1024,sizeof(double)); //Allocate a memory block of 1024x8 byte and store its address in p.
p[0]=1;    //will assign 1 to the first number in the array.
</pre><h2><a class="anchor" id="sect-const"></a>
Constness</h2>
<p>Beware about a const pointer and pointer that points to constant memory regions: </p><pre class="fragment">const double *p2;  //p2 is a pointer that points to a memory region that can not be changed. 
p2=p;              //ok
p2[0]=1;           //illegal.
double *const p3=p;//p2 is a constant pointer that can not have its value changed. 
p3=p;              //illegal
p3[0]=1;           //ok
</pre><h2><a class="anchor" id="sect-2d-pointer"></a>
Two Dimension Pointers</h2>
<p>A two-dimensional (2-d) pointer is like an array pointer. It stores the address of a memory region. However, unlike the array pointer, the compiler knows the length of the first dimension so that is can compute the memory location given 2-d index like <code>a</code>[2][3]; </p><pre class="fragment">double (*p)[3]=calloc(3*2,sizeof(double)); //can be used in the same way as double a[2][3];
</pre><p>Notice that in 2-d indexing <code>a</code>[2][3], the last index changes the fastest. <br />
 </p>
<h1><a class="anchor" id="sect-maos-data"></a>
MAOS Data Types</h1>
<h2><a class="anchor" id="sect-maos-math"></a>
Fundamental Math Types</h2>
<p>MAOS defines and uses a few structs to manage memory for basic math types. Those types are defined in the <code>math</code> folder.</p>
<p>For example, <a class="el" href="structdmat.html">dmat</a> is used for 1-d or 2-d double array, and <a class="el" href="structcmat.html">cmat</a> is used for complex array. There is a predefined macro #P() to help indexing the arrays: </p><pre class="fragment">dmat *a=dnew(10,4); //allocates memory like double a[4][10]
P(a,8,3)=1.;        //visits memory like a[3][8]
P(a,39)=1.;         //visits memory as if it is 1d array.
dfree(a);           //frees the memory
cmat *a2=cnew(10,4);
P(a2,7,3)=1.+1*I;
cfree(a2);
</pre><p>Sparse arrays are managed using <a class="el" href="structdsp.html">dsp</a> for double and <a class="el" href="structcsp.html">csp</a> for complex. </p><pre class="fragment">dsp *a3=dspnew(10,8,50); //10x8 array with maximum of 50 elements.
</pre><p>In addition, <a class="el" href="structloc__t.html">loc_t</a> is used to describe x and y coordinate of uniformly spaced points. <a class="el" href="structmap__t.html">map_t</a> is derived from <a class="el" href="structdmat.html">dmat</a> and used to describe 2-d array of opd or amplitude data with origin and resolution information.</p>
<p>Numerical arrays can be stores in <a class="el" href="structcell.html">cell</a> arrays like in matlab. Different types have their specific cell definitions. For example, <a class="el" href="structdcell.html">dcell</a> is used to contain <a class="el" href="structdmat.html">dmat</a> pointers, and <a class="el" href="structccell.html">ccell</a> is used to contain <a class="el" href="structcmat.html">cmat</a> pointers. All cell arrays share the same struct layout and can be allocated using <a class="el" href="cell_8c.html#af5ecd7ec0a002a20b2f5af006c9ae47a">cellnew()</a> and deallocated using <a class="el" href="cell_8h.html#a088fe3d13e53e5d92d0b9c0165d92420">cellfree()</a>. However, access elements is better handled with specific cell types to avoid casting. The <a class="el" href="structcell.html">cell</a> array can contain arbitrary points. </p><pre class="fragment">dcell *c=cellnew(4,4);//allocates a cell array.
P(c,2,1)=a;           //stores dmat pointer in a cell.
cellfree(c);

ccell *c2=cellnew(4,4);
P(c2,2,3)=a2;

dspcell*c3=cellnew(5,5);
P(c3,3,2)=a3;

cell *c4=cellnew(5,5);
P(c4,0,0)=a;
P(c4,1,0)=a2;
P(c4,2,0)=a3;
</pre><p>Functions for those fundamental math types are defined using macros that works similarly to the C++ template.</p>
<h2><a class="anchor" id="Specific"></a>
Types</h2>
<p>Specific calculation related types are often encapsulated in corresponding data types. Those types are defined in the <code>lib</code> folder. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->

   </ul>
 </div>
</body>
</html>
